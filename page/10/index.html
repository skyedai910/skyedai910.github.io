<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>SkYe231 Blog - 笔记📝</title><meta name="author" content="SkYe231"><meta name="copyright" content="SkYe231"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta property="og:type" content="website">
<meta property="og:title" content="SkYe231 Blog">
<meta property="og:url" content="https://www.mrskye.cn/page/10/index.html">
<meta property="og:site_name" content="SkYe231 Blog">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://www.mrskye.cn/img/avatar.png">
<meta property="article:author" content="SkYe231">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://www.mrskye.cn/img/avatar.png"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://www.mrskye.cn/page/10/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//www.google-analytics.com" crossorigin=""/><link rel="preconnect" href="//hm.baidu.com"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload="this.media='all'"><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?8184ae9371af7cedfa47d27c247e16b8";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script><script async="async" src="https://www.googletagmanager.com/gtag/js?id=UA-154693872-1"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-154693872-1');
</script><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: {"limitDay":500,"position":"top","messagePrev":"这篇文章距离上次更新已经","messageNext":"天，内容可能已经过时了。"},
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: true,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"limitCount":200,"languages":{"author":"作者: SkYe231","link":"链接: ","source":"来源: SkYe231 Blog","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#121212","position":"bottom-left"},
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: true,
  islazyload: true,
  isanchor: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'SkYe231 Blog',
  isPost: false,
  isHome: true,
  isHighlightShrink: false,
  isToc: false,
  postUpdate: '2022-03-25 15:52:42'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const fontSizeVal = saveToLocal.get('global-font-size')
    if (fontSizeVal !== undefined) {
      document.documentElement.style.setProperty('--global-font-size', fontSizeVal + 'px')
    }
    
    const detectApple = () => {
      if (GLOBAL_CONFIG_SITE.isHome && /iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="//at.alicdn.com/t/font_2567732_2yo06945456.css"><meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/atom.xml" title="SkYe231 Blog" type="application/atom+xml">
</head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="/img/avatar.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">文章</div><div class="length-num">161</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">标签</div><div class="length-num">195</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">分类</div><div class="length-num">20</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 目录</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-wrench"></i><span> 工具</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" target="_blank" rel="noopener" href="http://mrskye.gitee.io/cyberchef/"><i class="fa-fw fas fa-key"></i><span> cyberchef</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友情链接</span></a></div><div class="menus_item"><a class="site-page" target="_blank" rel="noopener" href="https://travellings.link"><i class="fa-fw fas fa-subway"></i><span> 开往</span></a></div><div class="menus_item"><a class="site-page" href="/atom.xml"><i class="fa-fw fas fa-rss"></i><span> RSS</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div></div></div><div class="page" id="body-wrap"><header class="full_page" id="page-header" style="background-image: url('/img/background.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">SkYe231 Blog</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 目录</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-wrench"></i><span> 工具</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" target="_blank" rel="noopener" href="http://mrskye.gitee.io/cyberchef/"><i class="fa-fw fas fa-key"></i><span> cyberchef</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友情链接</span></a></div><div class="menus_item"><a class="site-page" target="_blank" rel="noopener" href="https://travellings.link"><i class="fa-fw fas fa-subway"></i><span> 开往</span></a></div><div class="menus_item"><a class="site-page" href="/atom.xml"><i class="fa-fw fas fa-rss"></i><span> RSS</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="site-info"><h1 id="site-title">SkYe231 Blog</h1><div id="site-subtitle"><span id="subtitle"></span></div><div id="site_social_icons"><a class="social-icon" href="mailto:skye231@foxmail.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a><a class="social-icon" href="https://www.mrskye.cn/atom.xml" target="_blank" title="RSS"><i class="fas fa-rss"></i></a><a class="social-icon" href="http://wpa.qq.com/msgrd?uin=910437231" target="_blank" title="QQ"><i class="iconfont icon-QQ"></i></a></div></div><div id="scroll-down"><i class="fas fa-angle-down scroll-down-effects"></i></div></header><main class="layout" id="content-inner"><div class="recent-posts" id="recent-posts"><div class="recent-post-item"><div class="post_cover left_radius"><a href="/archives/501b87a3/" title="libc2.29_tcache_doublefree">     <img class="post_bg" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="/img/default_cover2.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="libc2.29_tcache_doublefree"></a></div><div class="recent-post-info"><a class="article-title" href="/archives/501b87a3/" title="libc2.29_tcache_doublefree">libc2.29_tcache_doublefree</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time class="post-meta-date-created" datetime="2020-11-27T07:14:29.000Z" title="发表于 2020-11-27 15:14:29">2020-11-27</time><span class="article-meta__separator">|</span><i class="fas fa-history"></i><span class="article-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2021-12-26T15:35:22.359Z" title="更新于 2021-12-26 23:35:22">2021-12-26</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Writeup/">Writeup</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/Pwn/">Pwn</a></span></div><div class="content">libc2.29_tcache_doublefree* CTF上遇到的题目。给的是最新版的 libc2.27 ，新增了在 libc2.29 上的 tcache double free 检测。
tcache 新增防护机制tcache_entryTcache_entry 结构体新增了指针 key 放在 bk 位，作用是检测 tcache double free ：
123456typedef struct tcache_entry&#123;  struct tcache_entry *next;  /* This field exists to detect double frees.  */  struct tcache_perthread_struct *key;&#125; tcache_entry;

tcache_put用 tcache_put() 放堆进 tcache bin 时，tcache_perthread_struct 地址被写入 e-&gt;key ，即 tcache 结构体堆地址写入释放堆的 bk 位：
1234567891011121314151617/* Ca ...</div></div></div><div class="recent-post-item"><div class="post_cover right_radius"><a href="/archives/5017c7a3/" title="Libc2.29类unlink_attack">     <img class="post_bg" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="/img/default_cover6.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Libc2.29类unlink_attack"></a></div><div class="recent-post-info"><a class="article-title" href="/archives/5017c7a3/" title="Libc2.29类unlink_attack">Libc2.29类unlink_attack</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time class="post-meta-date-created" datetime="2020-11-24T09:38:01.000Z" title="发表于 2020-11-24 17:38:01">2020-11-24</time><span class="article-meta__separator">|</span><i class="fas fa-history"></i><span class="article-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2022-03-25T07:47:44.252Z" title="更新于 2022-03-25 15:47:44">2022-03-25</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Pwn/">Pwn</a></span></div><div class="content">Libc2.29 unlink Attackunsortbin 变化libc2.23 没有对 unsortedbin 进行完整性检查：
1234567891011for (;; )  &#123;    int iters = 0;    while ((victim = unsorted_chunks (av)-&gt;bk) != unsorted_chunks (av))      &#123;        bck = victim-&gt;bk;        if (__builtin_expect (victim-&gt;size &lt;= 2 * SIZE_SZ, 0)            || __builtin_expect (victim-&gt;size &gt; av-&gt;system_mem, 0))          malloc_printerr (check_action, &quot;malloc(): memory corruption&quot;,                           chunk2mem (victim), ...</div></div></div><div class="recent-post-item"><div class="post_cover left_radius"><a href="/archives/784ac989/" title="unlink源码阅读总结">     <img class="post_bg" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="/img/default_cover2.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="unlink源码阅读总结"></a></div><div class="recent-post-info"><a class="article-title" href="/archives/784ac989/" title="unlink源码阅读总结">unlink源码阅读总结</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time class="post-meta-date-created" datetime="2020-11-22T09:47:29.000Z" title="发表于 2020-11-22 17:47:29">2020-11-22</time><span class="article-meta__separator">|</span><i class="fas fa-history"></i><span class="article-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2022-03-25T07:47:45.050Z" title="更新于 2022-03-25 15:47:45">2022-03-25</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/PWN/">PWN</a><i class="fas fa-angle-right"></i><a class="article-meta__categories" href="/categories/PWN/%E6%80%BB%E7%BB%93/">总结</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/unlink/">unlink</a></span></div><div class="content">合并优先级
先合并物理低地址空闲块
后合并物理高地址空闲快

合并过程Demo 程序
基于 glibc 2.23

1234567891011121314151617181920#include &lt;stdio.h&gt;#include &lt;stdlib.h&gt;char *ptr[16];int main()&#123;    char *protect;    ptr[0]=malloc(0xf8);    ptr[1]=malloc(0xf8);    ptr[2]=malloc(0xf8);    protect=malloc(0xf8);    free(ptr[0]);    free(ptr[2]);    free(ptr[1]);    return 0;&#125;

编译指令：
1gcc main.c -o main

Demo 说明程序中 chunk0 chunk2 释放顺序可以互换不影响，当释放 chunk1 会同时发生向前和向后 unlink ：

向前 unlink ：与物理地址高 chunk2 合并
向后 unlink ：与物理地址低 chu ...</div></div></div><div class="recent-post-item"><div class="post_cover right_radius"><a href="/archives/215/" title="2020 湖湘杯 PWN WriteUp">     <img class="post_bg" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="/img/default_cover5.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="2020 湖湘杯 PWN WriteUp"></a></div><div class="recent-post-info"><a class="article-title" href="/archives/215/" title="2020 湖湘杯 PWN WriteUp">2020 湖湘杯 PWN WriteUp</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time class="post-meta-date-created" datetime="2020-11-11T08:43:41.000Z" title="发表于 2020-11-11 16:43:41">2020-11-11</time><span class="article-meta__separator">|</span><i class="fas fa-history"></i><span class="article-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2021-03-26T08:28:21.457Z" title="更新于 2021-03-26 16:28:21">2021-03-26</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Writeup/">Writeup</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/%E6%B9%96%E6%B9%98%E6%9D%AF/">湖湘杯</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/Writeup/">Writeup</a></span></div><div class="content">
比赛的时候出去玩了，这就来复盘

babyheap基本情况增删查改，数量限制比较宽松挺大的，大小固定 0xf8 。
漏洞safe_read 写入大小为 0xf8 会溢出修改下一个 chunk size 最低两位为 \x00 。
123456789char *__fastcall safe_read(char *ptr, int size)&#123;  char *result; // rax  read(0, ptr, 0xF0uLL);  result = &amp;ptr[size];                          // 当size0xf8时就会溢出修改nextchunk size 低2位  *result = 0;  return result;&#125;

思路
unsortedbin 泄露 libc 地址
通过将堆放入 unsortedbin 修改某一个堆的 prev_size ，然后溢出修改 size 位，制造堆重叠，申请两个指向同一地址的指针
tcache double free

EXP12345678910111213141516171819 ...</div></div></div><div class="recent-post-item"><div class="post_cover left_radius"><a href="/archives/212/" title="2020 西普杯 信息安全铁人三项 第四赛区 Writeup">     <img class="post_bg" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="/img/default_cover4.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="2020 西普杯 信息安全铁人三项 第四赛区 Writeup"></a></div><div class="recent-post-info"><a class="article-title" href="/archives/212/" title="2020 西普杯 信息安全铁人三项 第四赛区 Writeup">2020 西普杯 信息安全铁人三项 第四赛区 Writeup</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time class="post-meta-date-created" datetime="2020-11-08T08:40:00.000Z" title="发表于 2020-11-08 16:40:00">2020-11-08</time><span class="article-meta__separator">|</span><i class="fas fa-history"></i><span class="article-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2022-03-25T07:47:44.643Z" title="更新于 2022-03-25 15:47:44">2022-03-25</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Writeup/">Writeup</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/Writeup/">Writeup</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/%E8%A5%BF%E6%99%AE%E6%9D%AF/">西普杯</a></span></div><div class="content">namepie基本情况程序有后门：

漏洞第二次输入栈溢出

思路pie 保护 partly write 绕过。
第一次输入泄露 canary ，第二次覆盖 rip 
EXP1234567891011121314151617181920from pwn import *context(log_level=&#x27;debug&#x27;)# p = process(&quot;./namepie&quot;)p = remote(&quot;172.20.14.168&quot;,9999)elf = ELF(&quot;./namepie&quot;)p.recvuntil(&quot;:\n&quot;)name = &#x27;skye&#x27;.ljust(0x30-0x8+1,&#x27;a&#x27;)p.send(name)p.recvuntil(&#x27;skye&#x27;.ljust(0x30-0x8,&#x27;a&#x27;))canary = u64(p.recv(8))-0x61log.info(&quot;canary:&quot;+hex(cana ...</div></div></div><div class="recent-post-item"><div class="post_cover right_radius"><a href="/archives/581bc7a3/" title="House_Of_Force">     <img class="post_bg" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="/img/default_cover3.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="House_Of_Force"></a></div><div class="recent-post-info"><a class="article-title" href="/archives/581bc7a3/" title="House_Of_Force">House_Of_Force</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time class="post-meta-date-created" datetime="2020-11-04T06:47:17.000Z" title="发表于 2020-11-04 14:47:17">2020-11-04</time><span class="article-meta__separator">|</span><i class="fas fa-history"></i><span class="article-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2022-03-25T07:47:44.247Z" title="更新于 2022-03-25 15:47:44">2022-03-25</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Writeup/">Writeup</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/Pwn/">Pwn</a></span></div><div class="content">House Of Forcetopchunk 分配机制
作为前置知识，回顾一下

当进行堆分配时，如果当前所有空闲（bin中）的堆块都无法满足条件，且 topchunk 大小可以满足需要空间的话，那么就会从 topchunk 中分割对应的大小用作堆块空间。
topchunk 大小是否满足的计算源码：
123456789101112131415161718// 获取当前的top chunk，并计算其对应的大小victim = av-&gt;top;size   = chunksize(victim);// 如果在分割之后，其大小仍然满足 chunk 的最小大小，那么就可以直接进行分割。if ((unsigned long) (size) &gt;= (unsigned long) (nb + MINSIZE)) &#123;    remainder_size = size - nb;    remainder      = chunk_at_offset(victim, nb);    av-&gt;top        = remainder;    set_head(victim, ...</div></div></div><div class="recent-post-item"><div class="post_cover left_radius"><a href="/archives/8b4e87b0/" title="SROP">     <img class="post_bg" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="/img/default_cover3.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="SROP"></a></div><div class="recent-post-info"><a class="article-title" href="/archives/8b4e87b0/" title="SROP">SROP</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time class="post-meta-date-created" datetime="2020-10-30T06:12:00.000Z" title="发表于 2020-10-30 14:12:00">2020-10-30</time><span class="article-meta__separator">|</span><i class="fas fa-history"></i><span class="article-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2022-03-25T07:47:44.363Z" title="更新于 2022-03-25 15:47:44">2022-03-25</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/PWN/">PWN</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/SROP/">SROP</a></span></div><div class="content">SROP简介SROP 的全称是 Sigreturn Oriented Programming 。这里sigreturn是一个系统调用，它在 unix 系统发生 signal 的时候会被间接地调用。
signal 机制简单来说就类 unix 系统中的一种中断信号机制，类似于单片机的各类中断服务信号，该机制常见步骤如下：

当内核向某个进程发起（ deliver ）一个 signal ，该进程会被暂时挂起（ suspend ），进入内核（1），然后内核为该进程保存相应的上下文，主要是将所有寄存器压入栈中，以及压入 signal 信息，以及指向 sigreturn 的系统调用地址。跳转到之前注册好的 signal handler 中处理相应signal（2），当 signal handler 返回之后（3），内核为该进程恢复之前保存的上下文，最后恢复进程的执行（4）。
Signal Frame 结构在第二步中被压入栈中，存储进程上下文的数据被称为 Signal Frame ，存放在用户进程的地址空间（栈）。下图中的绿、黄、橙色组成 Signal Frame 。


中断后执行的 signal ...</div></div></div><div class="recent-post-item"><div class="post_cover right_radius"><a href="/archives/36f80a82/" title="realloc_hook 调整栈帧使 onegadget 生效">     <img class="post_bg" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="/img/default_cover5.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="realloc_hook 调整栈帧使 onegadget 生效"></a></div><div class="recent-post-info"><a class="article-title" href="/archives/36f80a82/" title="realloc_hook 调整栈帧使 onegadget 生效">realloc_hook 调整栈帧使 onegadget 生效</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time class="post-meta-date-created" datetime="2020-10-13T15:32:00.000Z" title="发表于 2020-10-13 23:32:00">2020-10-13</time><span class="article-meta__separator">|</span><i class="fas fa-history"></i><span class="article-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2021-03-28T15:11:04.940Z" title="更新于 2021-03-28 23:11:04">2021-03-28</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/PWN/">PWN</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/PWN/">PWN</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/realloc-hook/">realloc_hook</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/onegadget/">onegadget</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/malloc-hook/">malloc_hook</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/%E5%90%88%E5%A4%A9/">合天</a></span></div><div class="content">[scode type=”lblue”]文章首发于合天众智，转载到博客仅作备份[/scode] 
在某些堆的题目当中，由于限制只能使用 house of spirit 等方法劫持 malloc_hook ，这种情况一般是往 malloc_hook 写入 onegadget ，再次申请堆来 getshell 。
由于栈帧情况不满足，查询到的所有 onegadget 可能都打不通，这时就可以考虑下用 malloc_hook 和 realloc_hook 结合。先通过 realloc 调整栈帧，然后在运行 onegadget 。
了解 reallocrealloc 在库函数中的作用是重新调整 malloc 或 calloc 所分配的堆大小。它和 malloc 函数一样有 hook 函数，当 hook 函数不为空时，就会跳转运行 hook 函数（和 malloc_hook 一样的）。
123456__int64 __fastcall realloc(signed __int64 a1, unsigned __int64 a2, __int64 a3)&#123;	……	if ( _reallo ...</div></div></div><div class="recent-post-item"><div class="post_cover left_radius"><a href="/archives/b65b3233/" title="Unsorted Bin Attack">     <img class="post_bg" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="/img/default_cover5.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Unsorted Bin Attack"></a></div><div class="recent-post-info"><a class="article-title" href="/archives/b65b3233/" title="Unsorted Bin Attack">Unsorted Bin Attack</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time class="post-meta-date-created" datetime="2020-10-05T07:29:00.000Z" title="发表于 2020-10-05 15:29:00">2020-10-05</time><span class="article-meta__separator">|</span><i class="fas fa-history"></i><span class="article-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2021-04-25T16:34:04.787Z" title="更新于 2021-04-26 00:34:04">2021-04-26</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/PWN/">PWN</a></span></div><div class="content">Unsorted Bin Attack概述Unsorted Bin Attack，顾名思义，该攻击与 Glibc 堆管理中的的 Unsorted Bin 的机制紧密相关。
Unsorted Bin Attack 被利用的前提是控制 Unsorted Bin Chunk 的 bk 指针。
Unsorted Bin Attack 可以达到的效果是实现修改任意地址值为一个较大的数值。
Unsorted Bin 回顾在介绍 Unsorted Bin 攻击前，可以先回顾一下 Unsorted Bin 的基本来源以及基本使用情况。
基本来源
当一个较大的 chunk 被分割成两半后，如果剩下的部分大于 MINSIZE，就会被放到 unsorted bin 中。
释放一个不属于 fast bin 的 chunk，并且该 chunk 不和 top chunk 紧邻时，该 chunk 会被首先放到 unsorted bin 中。关于 top chunk 的解释，请参考下面的介绍。
当进行 malloc_consolidate 时，可能会把合并后的 chunk 放到 unsorted bin 中，如果不是 ...</div></div></div><div class="recent-post-item"><div class="post_cover right_radius"><a href="/archives/dd6af626/" title="realloc学习">     <img class="post_bg" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="/img/default_cover3.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="realloc学习"></a></div><div class="recent-post-info"><a class="article-title" href="/archives/dd6af626/" title="realloc学习">realloc学习</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time class="post-meta-date-created" datetime="2020-10-04T16:16:26.000Z" title="发表于 2020-10-05 00:16:26">2020-10-05</time><span class="article-meta__separator">|</span><i class="fas fa-history"></i><span class="article-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2021-04-08T16:22:20.385Z" title="更新于 2021-04-09 00:22:20">2021-04-09</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/PWN/">PWN</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/%E5%A0%86/">堆</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/realloc/">realloc</a></span></div><div class="content">通过 realloc_hook 调整栈帧使 onegadget 生效在某些堆的题目当中，由于限制只能使用 house of spirit 等方法劫持 malloc_hook ，这种情况一般是往 malloc_hook 写入 onegadget ，再次申请堆来 getshell 。
由于栈帧情况不满足，查询到的所有 onegadget 可能都打不通，这时就可以考虑下用 malloc_hook 和 realloc_hook 结合。先通过 realloc 调整栈帧，然后在运行 onegadget 。
了解 reallocrealloc 在库函数中的作用是重新调整 malloc 或 calloc 所分配的堆大小。它和 malloc 函数一样有 hook 函数，当 hook 函数不为空时，就会跳转运行 hook 函数（和 malloc_hook 一样的）。
123456__int64 __fastcall realloc(signed __int64 a1, unsigned __int64 a2, __int64 a3)&#123;	……	if ( _realloc_hook )	return ...</div></div></div><nav id="pagination"><div class="pagination"><a class="extend prev" rel="prev" href="/page/9/#content-inner"><i class="fas fa-chevron-left fa-fw"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/9/#content-inner">9</a><span class="page-number current">10</span><a class="page-number" href="/page/11/#content-inner">11</a><span class="space">&hellip;</span><a class="page-number" href="/page/17/#content-inner">17</a><a class="extend next" rel="next" href="/page/11/#content-inner"><i class="fas fa-chevron-right fa-fw"></i></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="/img/avatar.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">SkYe231</div><div class="author-info__description"></div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">161</div></a></div><div class="card-info-data-item is-center"><a href="/tags/"><div class="headline">标签</div><div class="length-num">195</div></a></div><div class="card-info-data-item is-center"><a href="/categories/"><div class="headline">分类</div><div class="length-num">20</div></a></div></div><div class="card-info-social-icons is-center"><a class="social-icon" href="mailto:skye231@foxmail.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a><a class="social-icon" href="https://www.mrskye.cn/atom.xml" target="_blank" title="RSS"><i class="fas fa-rss"></i></a><a class="social-icon" href="http://wpa.qq.com/msgrd?uin=910437231" target="_blank" title="QQ"><i class="iconfont icon-QQ"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>公告</span></div><div class="announcement_content">请修改默认公告</div></div><div class="sticky_layout"><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/archives/dcfd805b/" title="安卓7以上APP抓包环境配置"><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="/img/default_cover2.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="安卓7以上APP抓包环境配置"/></a><div class="content"><a class="title" href="/archives/dcfd805b/" title="安卓7以上APP抓包环境配置">安卓7以上APP抓包环境配置</a><time datetime="2022-03-25T07:47:45.279Z" title="更新于 2022-03-25 15:47:45">2022-03-25</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/archives/d85b8fc8/" title="树莓派4b抓取IOT流量环境配置"><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="/img/default_cover0.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="树莓派4b抓取IOT流量环境配置"/></a><div class="content"><a class="title" href="/archives/d85b8fc8/" title="树莓派4b抓取IOT流量环境配置">树莓派4b抓取IOT流量环境配置</a><time datetime="2022-03-25T07:47:45.278Z" title="更新于 2022-03-25 15:47:45">2022-03-25</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/archives/d4cc29fc/" title="d4cc29fc"><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="/img/default_cover4.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="d4cc29fc"/></a><div class="content"><a class="title" href="/archives/d4cc29fc/" title="d4cc29fc">d4cc29fc</a><time datetime="2022-03-25T07:47:45.259Z" title="更新于 2022-03-25 15:47:45">2022-03-25</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/archives/1321cf/" title="树莓派开启VNC远程连接"><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="/img/default_cover1.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="树莓派开启VNC远程连接"/></a><div class="content"><a class="title" href="/archives/1321cf/" title="树莓派开启VNC远程连接">树莓派开启VNC远程连接</a><time datetime="2022-03-25T07:47:45.258Z" title="更新于 2022-03-25 15:47:45">2022-03-25</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/archives/8c4c947e/" title="代码执行"><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="/img/default_cover0.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="代码执行"/></a><div class="content"><a class="title" href="/archives/8c4c947e/" title="代码执行">代码执行</a><time datetime="2022-03-25T07:47:45.258Z" title="更新于 2022-03-25 15:47:45">2022-03-25</time></div></div></div></div><div class="card-widget" id="card-newest-comments"><div class="item-headline"><i class="fas fa-comment-dots"></i><span>最新评论</span></div><div class="aside-list"><span>正在加载中...</span></div></div><div class="card-widget card-categories"><div class="item-headline">
            <i class="fas fa-folder-open"></i>
            <span>分类</span>
            <a class="card-more-btn" href="/categories/" title="查看更多">
    <i class="fas fa-angle-right"></i></a>
            </div>
            <ul class="card-category-list" id="aside-cat-list">
            <li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Crypto/"><span class="card-category-list-name">Crypto</span><span class="card-category-list-count">3</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/IOT/"><span class="card-category-list-name">IOT</span><span class="card-category-list-count">9</span></a><ul class="card-category-list child"><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/IOT/%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/"><span class="card-category-list-name">漏洞复现</span><span class="card-category-list-count">4</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/IOT/%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/"><span class="card-category-list-name">环境配置</span><span class="card-category-list-count">2</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/IOT/%E8%B5%84%E6%96%99/"><span class="card-category-list-name">资料</span><span class="card-category-list-count">1</span></a></li></ul></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/MISC/"><span class="card-category-list-name">MISC</span><span class="card-category-list-count">3</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/PWN/"><span class="card-category-list-name">PWN</span><span class="card-category-list-count">39</span></a><ul class="card-category-list child"><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/PWN/ARM/"><span class="card-category-list-name">ARM</span><span class="card-category-list-count">1</span></a></li></ul></li>
            </ul></div><div class="card-widget card-tags"><div class="item-headline"><i class="fas fa-tags"></i><span>标签</span></div><div class="card-tag-cloud"><a href="/tags/Dlink/" style="font-size: 1.15em; color: rgb(155, 137, 80)">Dlink</a><a href="/tags/NCTF/" style="font-size: 1.15em; color: rgb(130, 59, 82)">NCTF</a><a href="/tags/glibc2-32/" style="font-size: 1.15em; color: rgb(143, 191, 133)">glibc2.32</a><a href="/tags/UAF/" style="font-size: 1.25em; color: rgb(4, 195, 5)">UAF</a><a href="/tags/NSSCCTF/" style="font-size: 1.15em; color: rgb(146, 197, 143)">NSSCCTF</a><a href="/tags/ijctf/" style="font-size: 1.15em; color: rgb(113, 109, 51)">ijctf</a><a href="/tags/%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2/" style="font-size: 1.25em; color: rgb(57, 86, 84)">格式化字符串</a><a href="/tags/%E5%B9%BF%E4%B8%9C%E7%9C%81%E5%BC%BA%E7%BD%91%E6%9D%AF/" style="font-size: 1.15em; color: rgb(162, 108, 85)">广东省强网杯</a><a href="/tags/%E5%BC%BA%E7%BD%91%E6%9D%AF/" style="font-size: 1.15em; color: rgb(197, 109, 148)">强网杯</a><a href="/tags/%E6%B9%96%E6%B9%98%E6%9D%AF/" style="font-size: 1.25em; color: rgb(87, 59, 105)">湖湘杯</a><a href="/tags/%E7%BE%8A%E5%9F%8E%E6%9D%AF/" style="font-size: 1.25em; color: rgb(158, 114, 190)">羊城杯</a><a href="/tags/%E6%B2%99%E7%9B%92%E5%A0%86/" style="font-size: 1.45em; color: rgb(194, 64, 184)">沙盒堆</a><a href="/tags/%E8%A5%BF%E6%B9%96%E8%AE%BA%E5%89%91/" style="font-size: 1.25em; color: rgb(113, 30, 59)">西湖论剑</a><a href="/tags/%E9%95%BF%E5%AE%89%E6%9D%AF/" style="font-size: 1.25em; color: rgb(158, 177, 100)">长安杯</a><a href="/tags/%E9%B9%A4%E5%9F%8E%E6%9D%AF/" style="font-size: 1.15em; color: rgb(166, 98, 15)">鹤城杯</a><a href="/tags/Handsome/" style="font-size: 1.15em; color: rgb(185, 48, 163)">Handsome</a><a href="/tags/%E7%BE%8E%E5%8C%96/" style="font-size: 1.15em; color: rgb(161, 166, 146)">美化</a><a href="/tags/typecho/" style="font-size: 1.15em; color: rgb(168, 145, 198)">typecho</a><a href="/tags/WordPress/" style="font-size: 1.15em; color: rgb(153, 23, 33)">WordPress</a><a href="/tags/%E9%82%AE%E4%BB%B6%E9%80%9A%E7%9F%A5/" style="font-size: 1.15em; color: rgb(175, 171, 62)">邮件通知</a><a href="/tags/busybox/" style="font-size: 1.15em; color: rgb(71, 18, 5)">busybox</a><a href="/tags/house-of-banana/" style="font-size: 1.15em; color: rgb(122, 113, 173)">house of banana</a><a href="/tags/largebin-attack/" style="font-size: 1.15em; color: rgb(191, 43, 82)">largebin attack</a><a href="/tags/ida/" style="font-size: 1.25em; color: rgb(192, 76, 192)">ida</a><a href="/tags/grep/" style="font-size: 1.15em; color: rgb(187, 139, 3)">grep</a><a href="/tags/nfc/" style="font-size: 1.15em; color: rgb(199, 17, 198)">nfc</a><a href="/tags/PN532/" style="font-size: 1.15em; color: rgb(154, 148, 136)">PN532</a><a href="/tags/EOF/" style="font-size: 1.15em; color: rgb(124, 41, 121)">EOF</a><a href="/tags/unlink/" style="font-size: 1.35em; color: rgb(109, 99, 0)">unlink</a><a href="/tags/offbynull/" style="font-size: 1.25em; color: rgb(192, 122, 125)">offbynull</a><a href="/tags/scanf/" style="font-size: 1.15em; color: rgb(101, 3, 175)">scanf</a><a href="/tags/steam/" style="font-size: 1.15em; color: rgb(141, 161, 182)">steam</a><a href="/tags/asf/" style="font-size: 1.15em; color: rgb(64, 134, 59)">asf</a><a href="/tags/Steam%E4%BA%91%E6%8C%82%E5%8D%A1/" style="font-size: 1.15em; color: rgb(68, 88, 2)">Steam云挂卡</a><a href="/tags/HackRF/" style="font-size: 1.15em; color: rgb(163, 173, 8)">HackRF</a><a href="/tags/GPS%E5%AE%9A%E4%BD%8D%E6%AC%BA%E9%AA%97/" style="font-size: 1.15em; color: rgb(67, 137, 151)">GPS定位欺骗</a><a href="/tags/%E8%8A%B1%E6%8C%87%E4%BB%A4/" style="font-size: 1.15em; color: rgb(79, 128, 141)">花指令</a><a href="/tags/%E4%BA%A4%E9%80%9A%E7%81%AF/" style="font-size: 1.15em; color: rgb(93, 169, 50)">交通灯</a><a href="/tags/%E5%8D%95%E7%89%87%E6%9C%BA/" style="font-size: 1.15em; color: rgb(137, 127, 97)">单片机</a><a href="/tags/C51/" style="font-size: 1.15em; color: rgb(51, 130, 168)">C51</a></div></div><div class="card-widget card-archives"><div class="item-headline"><i class="fas fa-archive"></i><span>归档</span><a class="card-more-btn" href="/archives/" title="查看更多">
    <i class="fas fa-angle-right"></i></a></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2022/03/"><span class="card-archive-list-date">三月 2022</span><span class="card-archive-list-count">3</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2022/02/"><span class="card-archive-list-date">二月 2022</span><span class="card-archive-list-count">2</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2022/01/"><span class="card-archive-list-date">一月 2022</span><span class="card-archive-list-count">8</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2021/12/"><span class="card-archive-list-date">十二月 2021</span><span class="card-archive-list-count">10</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2021/11/"><span class="card-archive-list-date">十一月 2021</span><span class="card-archive-list-count">3</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2021/10/"><span class="card-archive-list-date">十月 2021</span><span class="card-archive-list-count">4</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2021/09/"><span class="card-archive-list-date">九月 2021</span><span class="card-archive-list-count">8</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2021/08/"><span class="card-archive-list-date">八月 2021</span><span class="card-archive-list-count">4</span></a></li></ul></div><div class="card-widget card-webinfo"><div class="item-headline"><i class="fas fa-chart-line"></i><span>网站资讯</span></div><div class="webinfo"><div class="webinfo-item"><div class="item-name">文章数目 :</div><div class="item-count">161</div></div><div class="webinfo-item"><div class="item-name">已运行时间 :</div><div class="item-count" id="runtimeshow" data-publishDate="2019-05-31T16:00:00.000Z"></div></div><div class="webinfo-item"><div class="item-name">本站总字数 :</div><div class="item-count">316.9k</div></div><div class="webinfo-item"><div class="item-name">本站访客数 :</div><div class="item-count" id="busuanzi_value_site_uv"></div></div><div class="webinfo-item"><div class="item-name">本站总访问量 :</div><div class="item-count" id="busuanzi_value_site_pv"></div></div><div class="webinfo-item"><div class="item-name">最后更新时间 :</div><div class="item-count" id="last-push-date" data-lastPushDate="2022-03-25T07:52:40.519Z"></div></div></div></div></div></div></main><footer id="footer" style="background-image: url('/img/background.jpg')"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2022 By SkYe231</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text"><a href="https://cloud.tencent.com/product/wh?from=12331" target="_blank">Hosted BY 云开发 Cloudbase</a>&nbsp;|&nbsp;<a href="https://www.upyun.com/?utm_source=lianmeng&utm_medium=referral" target="_blank"><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://mrskye.cn-gd.ufileos.com/img/2020-07-01-lGwrnPz3GuV4odmM.png" align="top" style="width:48px"></a><br /><div class="github-badge"><a rel="license" href="http://beian.miit.gov.cn/" target="_blank" title="粤ICP备20056619号"><span class="badge-subject">粤ICP备</span><span class="badge-value bg-black">20056619号</span></a></div></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="font-plus" type="button" title="放大字体"><i class="fas fa-plus"></i></button><button id="font-minus" type="button" title="缩小字体"><i class="fas fa-minus"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div></div><hr/><div id="local-search-results"></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.autoSpacingPage()
  else {
    getScript('https://cdn.jsdelivr.net/npm/pangu/dist/browser/pangu.min.js')
      .then(() => {
        pangu.autoSpacingPage()
      })
  }
}

function panguInit () {
  if (false){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><script src="/js/search/local-search.js"></script><script>var preloader = {
  endLoading: () => {
    document.body.style.overflow = 'auto';
    document.getElementById('loading-box').classList.add("loaded")
  },
  initLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.remove("loaded")

  }
}
window.addEventListener('load',preloader.endLoading())</script><div class="js-pjax"><script>function subtitleType () {
  fetch('https://v1.hitokoto.cn')
    .then(response => response.json())
    .then(data => {
      if (true) {
        var from = '出自 ' + data.from
        var sub = "".length == 0 ? new Array() : "".split(',')
        var both = sub.unshift(data.hitokoto, from)
        var typed = new Typed('#subtitle', {
          strings: sub,
          startDelay: 300,
          typeSpeed: 150,
          loop: true,
          backSpeed: 50,
        })
      } else {
        document.getElementById('subtitle').innerHTML = data.hitokoto
      }
    })
}

if (true) {
  if (typeof Typed === 'function') {
    subtitleType()
  } else {
    getScript('https://cdn.jsdelivr.net/npm/typed.js/lib/typed.min.js').then(subtitleType)
  }
} else {
  subtitleType()
}
</script><script>if (document.getElementsByClassName('mermaid').length) {
  if (window.mermaidJsLoad) mermaid.init()
  else {
    getScript('https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js').then(() => {
      window.mermaidJsLoad = true
      mermaid.initialize({
        theme: 'default',
      })
      false && mermaid.init()
    })
  }
}</script></div><script defer="defer" id="ribbon" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-ribbon.min.js" size="150" alpha="0.6" zIndex="-1" mobile="false" data-click="false"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = false;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><script id="click-show-text" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/click-show-text.min.js" data-mobile="false" data-text="富强,民主,文明,和谐,自由,平等,公正,法治,爱国,敬业,诚信,友善" data-fontsize="15px" data-random="true" async="async"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>