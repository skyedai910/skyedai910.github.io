<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>SkYe231 Blog - 笔记📝</title><meta name="author" content="SkYe231"><meta name="copyright" content="SkYe231"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta property="og:type" content="website">
<meta property="og:title" content="SkYe231 Blog">
<meta property="og:url" content="https://www.mrskye.cn/page/4/index.html">
<meta property="og:site_name" content="SkYe231 Blog">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://www.mrskye.cn/img/avatar.png">
<meta property="article:author" content="SkYe231">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://www.mrskye.cn/img/avatar.png"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://www.mrskye.cn/page/4/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//www.google-analytics.com" crossorigin=""/><link rel="preconnect" href="//hm.baidu.com"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload="this.media='all'"><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?8184ae9371af7cedfa47d27c247e16b8";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script><script async="async" src="https://www.googletagmanager.com/gtag/js?id=UA-154693872-1"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-154693872-1');
</script><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: {"limitDay":500,"position":"top","messagePrev":"这篇文章距离上次更新已经","messageNext":"天，内容可能已经过时了。"},
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: true,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"limitCount":200,"languages":{"author":"作者: SkYe231","link":"链接: ","source":"来源: SkYe231 Blog","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#121212","position":"bottom-left"},
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: true,
  islazyload: true,
  isanchor: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'SkYe231 Blog',
  isPost: false,
  isHome: true,
  isHighlightShrink: false,
  isToc: false,
  postUpdate: '2022-01-19 15:14:31'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const fontSizeVal = saveToLocal.get('global-font-size')
    if (fontSizeVal !== undefined) {
      document.documentElement.style.setProperty('--global-font-size', fontSizeVal + 'px')
    }
    
    const detectApple = () => {
      if (GLOBAL_CONFIG_SITE.isHome && /iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="//at.alicdn.com/t/font_2567732_2yo06945456.css"><meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/atom.xml" title="SkYe231 Blog" type="application/atom+xml">
</head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="/img/avatar.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">文章</div><div class="length-num">152</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">标签</div><div class="length-num">188</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">分类</div><div class="length-num">19</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 目录</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-wrench"></i><span> 工具</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" target="_blank" rel="noopener" href="http://mrskye.gitee.io/cyberchef/"><i class="fa-fw fas fa-key"></i><span> cyberchef</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友情链接</span></a></div><div class="menus_item"><a class="site-page" target="_blank" rel="noopener" href="https://travellings.link"><i class="fa-fw fas fa-subway"></i><span> 开往</span></a></div><div class="menus_item"><a class="site-page" href="/atom.xml"><i class="fa-fw fas fa-rss"></i><span> RSS</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div></div></div><div class="page" id="body-wrap"><header class="full_page" id="page-header" style="background-image: url('/img/background.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">SkYe231 Blog</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 目录</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-wrench"></i><span> 工具</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" target="_blank" rel="noopener" href="http://mrskye.gitee.io/cyberchef/"><i class="fa-fw fas fa-key"></i><span> cyberchef</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友情链接</span></a></div><div class="menus_item"><a class="site-page" target="_blank" rel="noopener" href="https://travellings.link"><i class="fa-fw fas fa-subway"></i><span> 开往</span></a></div><div class="menus_item"><a class="site-page" href="/atom.xml"><i class="fa-fw fas fa-rss"></i><span> RSS</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="site-info"><h1 id="site-title">SkYe231 Blog</h1><div id="site-subtitle"><span id="subtitle"></span></div><div id="site_social_icons"><a class="social-icon" href="mailto:skye231@foxmail.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a><a class="social-icon" href="https://www.mrskye.cn/atom.xml" target="_blank" title="RSS"><i class="fas fa-rss"></i></a><a class="social-icon" href="http://wpa.qq.com/msgrd?uin=910437231" target="_blank" title="QQ"><i class="iconfont icon-QQ"></i></a></div></div><div id="scroll-down"><i class="fas fa-angle-down scroll-down-effects"></i></div></header><main class="layout" id="content-inner"><div class="recent-posts" id="recent-posts"><div class="recent-post-item"><div class="post_cover left_radius"><a href="/archives/fa64a24c/" title="2021 蓝帽杯决赛 writeup">     <img class="post_bg" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="/img/default_cover3.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="2021 蓝帽杯决赛 writeup"></a></div><div class="recent-post-info"><a class="article-title" href="/archives/fa64a24c/" title="2021 蓝帽杯决赛 writeup">2021 蓝帽杯决赛 writeup</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time class="post-meta-date-created" datetime="2021-08-24T08:16:56.000Z" title="发表于 2021-08-24 16:16:56">2021-08-24</time><span class="article-meta__separator">|</span><i class="fas fa-history"></i><span class="article-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2021-09-07T15:31:44.276Z" title="更新于 2021-09-07 23:31:44">2021-09-07</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Writeup/">Writeup</a></span></div><div class="content">secretcode去年决赛、今年线上初赛题目、今年决赛还是这题，一题 3 次
考点还是那样 open read 通过延时爆破 flag ，这次沙箱就多了个规则需要 fd 大于 0x14 才能调用 read ，多写一个 while 循环的事情
由于多了 while 循环 flag 位置变了一下，直接从第二个字符开始爆破
1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374# encoding=utf-8from pwn import *file_path = &quot;./chall&quot;context.arch = &quot;amd64&quot;# context.log_level = &quot;debug&quot;context.terminal = [&#x27;tmux&#x27;, &#x27;splitw&#x27;, &#x27;- ...</div></div></div><div class="recent-post-item"><div class="post_cover right_radius"><a href="/archives/b0b9566a/" title="2021_巅峰极客Writeup">     <img class="post_bg" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="/img/default_cover0.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="2021_巅峰极客Writeup"></a></div><div class="recent-post-info"><a class="article-title" href="/archives/b0b9566a/" title="2021_巅峰极客Writeup">2021_巅峰极客Writeup</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time class="post-meta-date-created" datetime="2021-08-10T02:03:07.000Z" title="发表于 2021-08-10 10:03:07">2021-08-10</time><span class="article-meta__separator">|</span><i class="fas fa-history"></i><span class="article-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2021-09-07T15:31:50.904Z" title="更新于 2021-09-07 23:31:50">2021-09-07</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Writeup/">Writeup</a></span></div><div class="content">mimic-game拟态题目，语言实现同一个程序，最后通过 obs 同时运行。
Mimic32 guess 输出的时候有个栈溢出：

程序是 32 位、RELRO 是部分保护 ret2dlsolved 利用，直接套 pwntools 生成 payload 模板：msgparser
12345678910111213141516171819202122from pwn import *context.log_level=&quot;debug&quot;context.terminal = [&#x27;tmux&#x27;,&#x27;sp&#x27;,&#x27;-h&#x27;]context.binary = elf = ELF(&#x27;./mimic32&#x27;)context.arch = &#x27;i386&#x27;p = process(&quot;./mimic32&quot;)# gdb.attach(p,&quot;b *0x080489A7&quot;)# pause()rop = ROP(context.binary)dlresolve = Ret2 ...</div></div></div><div class="recent-post-item"><div class="post_cover left_radius"><a href="/archives/3a92d93f/" title="ret2dlresolve">     <img class="post_bg" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="/img/default_cover6.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="ret2dlresolve"></a></div><div class="recent-post-info"><a class="article-title" href="/archives/3a92d93f/" title="ret2dlresolve">ret2dlresolve</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time class="post-meta-date-created" datetime="2021-08-03T06:02:14.000Z" title="发表于 2021-08-03 14:02:14">2021-08-03</time><span class="article-meta__separator">|</span><i class="fas fa-history"></i><span class="article-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2021-09-06T13:35:06.326Z" title="更新于 2021-09-06 21:35:06">2021-09-06</time></span></div><div class="content">ret2dlresolve原理概述linux 动态链接的程序使用 _dl_runtime_resolve(link_map_obj, reloc_offset) 来对动态链接的函数进行重定位。
动态链接器在解析符号（函数）地址时需要使用：重定位表项、动态符号表、动态字符串表等。如果能够修改其中的某些内容，就能使得动态链接器解析的符号（函数）是我们想要解析的符号（函数）。
攻击效果让被攻击的函数变成我们所需要的函数，且被攻击函数 got 表也被劫持为目标函数的地址
使用限制依据保护分几种的    
使用场景利用ROP技巧,可以绕过NX和ASLR保护,比较适用于一些比较简单的栈溢出情况,但是同时难以泄漏获取更多信息的情况(比如没办法获取到libc版本)
延迟绑定技术
以下基于 32 位程序，64 位差异不大

ret2dlresolve 需要了解动态链接的基本过程以及 ELF 文件中动态链接相关的结构（段、表）
延迟绑定相关段、表、结构体
结构体定义文件：/glibc-2.23/elf/elf.h

PLT表在程序中以 .plt 节表示
每一个表项表示了一个与要重定位的函数相关的若干条指令 ...</div></div></div><div class="recent-post-item"><div class="post_cover right_radius"><a href="/archives/887a5205/" title="2021红帽杯决赛Writeup">     <img class="post_bg" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="/img/default_cover5.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="2021红帽杯决赛Writeup"></a></div><div class="recent-post-info"><a class="article-title" href="/archives/887a5205/" title="2021红帽杯决赛Writeup">2021红帽杯决赛Writeup</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time class="post-meta-date-created" datetime="2021-07-27T06:36:37.000Z" title="发表于 2021-07-27 14:36:37">2021-07-27</time><span class="article-meta__separator">|</span><i class="fas fa-history"></i><span class="article-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2021-07-30T06:23:40.351Z" title="更新于 2021-07-30 14:23:40">2021-07-30</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Writeup/">Writeup</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/Rust/">Rust</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/httpd/">httpd</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/python%E8%A7%A3%E9%87%8A%E5%99%A8/">python解释器</a></span></div><div class="content">oooohMsgHTTPc语言实现的 http 服务，和路由器固件的一样有个路由表：


/weclome ：泄露出 pie
/login_user &amp; /register_user ：登录&amp;注册
/add_message ：申请堆块
/del_message ：释放堆块。根据输入的 message_id 和登录时产生的用户标志判断是否有权限删除对应堆块。
/get_message ：选中堆块，将堆块地址赋值到全局变量。根据输入的 secret 和身份标识来判断，当 secret 匹配且身份标识不匹配时，选中堆块。
/empty_message ：释放选中的堆块，并置零全局变量。
/show_message ： 输出选中的堆块内容
/exit ： 退出当前用户，清空用户标识，但保留创建的堆块

从以上功能可以看出来存在 UAF 漏洞：用户 A 申请堆块 1 ，然后切换用户 B 选中堆块 1 ，接着换回用户 A 通过 del_message 释放堆块 1 ，最后用户 B 通过 show_message 泄露 bin 中堆块信息，empty_message 实现 doubl ...</div></div></div><div class="recent-post-item"><div class="post_cover left_radius"><a href="/archives/562e05a9/" title="2021卫生CTFWritreup">     <img class="post_bg" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="/img/default_cover3.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="2021卫生CTFWritreup"></a></div><div class="recent-post-info"><a class="article-title" href="/archives/562e05a9/" title="2021卫生CTFWritreup">2021卫生CTFWritreup</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time class="post-meta-date-created" datetime="2021-07-26T01:08:30.000Z" title="发表于 2021-07-26 09:08:30">2021-07-26</time><span class="article-meta__separator">|</span><i class="fas fa-history"></i><span class="article-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2021-07-28T03:29:39.832Z" title="更新于 2021-07-28 11:29:39">2021-07-28</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Writeup/">Writeup</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/arm%EF%BC%8CUAF/">arm，UAF</a></span></div><div class="content">notebookadd 构造固定大小 0x108 的堆块，用下一个堆块的 prev_size 来构造链表，全局标志位记录链头的地址。问题在于 free 的没有重新调整找个链表的结构，依然保持着相同的链表结构。利用 show 可以将整个链表打印出来，需要是要调整全局指针和 unsortedbin 的关系，因为 free 进入unsortedbin 之后，下个堆的 prev_size 会被修改为 0x110 ，导致 show 的时候地址不可读而报错退出。

EXP12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758from pwn import *context.log_level = &#x27;debug&#x27;#p = process(&quot;./chall&quot;)p = process(&quot;./chall&quot;, env=&#123;&quot;LD_PRELOAD&quot;:&quot;./ ...</div></div></div><div class="recent-post-item"><div class="post_cover right_radius"><a href="/archives/d1763e3c/" title="2021 ijctf Writeup">     <img class="post_bg" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="/img/default_cover0.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="2021 ijctf Writeup"></a></div><div class="recent-post-info"><a class="article-title" href="/archives/d1763e3c/" title="2021 ijctf Writeup">2021 ijctf Writeup</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time class="post-meta-date-created" datetime="2021-07-24T15:28:50.000Z" title="发表于 2021-07-24 23:28:50">2021-07-24</time><span class="article-meta__separator">|</span><i class="fas fa-history"></i><span class="article-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2021-10-04T14:50:37.962Z" title="更新于 2021-10-04 22:50:37">2021-10-04</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Writeup/">Writeup</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/ijctf/">ijctf</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2/">格式化字符串</a></span></div><div class="content">baby-sum简而言之的话就是格式化字符串加上特殊栈空间排布
welcome 函数泄露出栈地址；cala 里面有个循环写入的功能函数，写入内容之后会调用 vuln ，里面就一个格式化函数漏洞；
使用 scanf(‘%8s’, &amp;num) 在堆栈上读取 3 个输入 (0,1,2)，num 是堆栈上指向 numbers[] 数组的指针，该数组每轮递增，偏移量：

6 –&gt; 起始地址
7 –&gt; 数字地址[0]
8 –&gt; 下一帧指针（指向偏移量 16）
9 –&gt; 从 calc() 返回 vuln() 的地址
10 –&gt; 数字 [0] 在 [rbp-0x30]
11 –&gt; 数字 [1] 在 [rbp-0x28]
12 –&gt; [rbp-0x20] 处的格式将在 calc() 开始时设置为“%8s”
13 –&gt; sum 变量，在 calc() 开头未定义…（可以通过welcome() 函数设置，qword 在（名称字符串+ 0x28）
14 –&gt; i 在 [rbp-0x10] 处的变量在每轮增加 (0,1,2)
15 –&gt; [rb ...</div></div></div><div class="recent-post-item"><div class="post_cover left_radius"><a href="/archives/25a80e2a/" title="2021国赛华北赛区决赛Writeup">     <img class="post_bg" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="/img/default_cover3.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="2021国赛华北赛区决赛Writeup"></a></div><div class="recent-post-info"><a class="article-title" href="/archives/25a80e2a/" title="2021国赛华北赛区决赛Writeup">2021国赛华北赛区决赛Writeup</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time class="post-meta-date-created" datetime="2021-06-24T06:21:23.000Z" title="发表于 2021-06-24 14:21:23">2021-06-24</time><span class="article-meta__separator">|</span><i class="fas fa-history"></i><span class="article-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2021-06-26T09:54:43.329Z" title="更新于 2021-06-26 17:54:43">2021-06-26</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Writeup/">Writeup</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/%E5%9B%BD%E8%B5%9B/">国赛</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/CICSN/">CICSN</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/%E6%A0%88%E8%BF%81%E7%A7%BB/">栈迁移</a></span></div><div class="content">Pwn_checkinglibc 2.32 影响不大，没有涉及相关的防护措施，也给了 ld ，更好模拟远程换下加载方式：
1p = process([&quot;./ld-2.32.so&quot;, &quot;./pwn&quot;], env=&#123;&quot;LD_PRELOAD&quot;:&quot;./libc.so.6&quot;&#125;)

开局给了 text 段的地址，PIE 等于没开。然后可以想 bss 段写入非常长字符串，这里写入的应该是 ropchain ，因为这段空间没有执行权限。接着就是有一个栈溢出，溢出长度刚好覆盖 rip ，结合前面往 bss 段写入内容，判断是栈迁移。

elf 中没有足够的函数和 gadget ，决定第一步先用 puts 泄露出 libc 基地址，然后写入第二次的 ropchain ，设想构造之前遇到过的栈迁移的结构：

1234payload = &#x27;a&#x27;*0x800#&#x27;a&#x27;*(0x800-8)+p64(bss+0x840-8)payload += p64(pop_rdi_ret)+ ...</div></div></div><div class="recent-post-item"><div class="post_cover right_radius"><a href="/archives/3cd31180/" title="仅offbynull攻击总结">     <img class="post_bg" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="/img/default_cover2.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="仅offbynull攻击总结"></a></div><div class="recent-post-info"><a class="article-title" href="/archives/3cd31180/" title="仅offbynull攻击总结">仅offbynull攻击总结</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time class="post-meta-date-created" datetime="2021-06-21T15:38:01.000Z" title="发表于 2021-06-21 23:38:01">2021-06-21</time><span class="article-meta__separator">|</span><i class="fas fa-history"></i><span class="article-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2021-06-23T15:31:53.064Z" title="更新于 2021-06-23 23:31:53">2021-06-23</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/PWN/">PWN</a><i class="fas fa-angle-right"></i><a class="article-meta__categories" href="/categories/PWN/%E6%80%BB%E7%BB%93/">总结</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/offbynull/">offbynull</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/scanf/">scanf</a></span></div><div class="content">特征标志
仅存在 off by null 漏洞

不能申请大于 fastbin 的堆块（可以申请也能用这种方法）
如果能申请大于 fastbin 的堆块，申请 0x101 覆盖成 0x100 并控制 prev_size ，就能向低地址的堆块合并

存在 scanf （或其他将 fastbin 放置到 unsortedbin 的途径）
单纯 offbynull 无法在 fastbin 中利用，需要结合 unsortedbin


适用glibc版本无论有无 tcache ，都能适用。
存在 tcache 则需要先将对应 size 填满，才能放入 fastbin 。
攻击效果造成堆重叠（chunk extend），进而控制各类 bin 中的指针，完成 getshell
原理难点在于：fastbin 堆块的 size 长度为 1 个字节（如：0xf0），如果 offbynull 覆盖 prev_inuse 时，会将整个 size 覆盖为 0x00 ，而这会引起报错。
解决思路：

利用 unsortedbin 形成时，会将其所在的前一个（高地址）非 topchunk 的堆块 prev_siz ...</div></div></div><div class="recent-post-item"><div class="post_cover left_radius"><a href="/archives/ba728db4/" title="2021国赛华南赛区决赛Writeup">     <img class="post_bg" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="/img/default_cover5.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="2021国赛华南赛区决赛Writeup"></a></div><div class="recent-post-info"><a class="article-title" href="/archives/ba728db4/" title="2021国赛华南赛区决赛Writeup">2021国赛华南赛区决赛Writeup</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time class="post-meta-date-created" datetime="2021-06-20T11:57:14.000Z" title="发表于 2021-06-20 19:57:14">2021-06-20</time><span class="article-meta__separator">|</span><i class="fas fa-history"></i><span class="article-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2021-07-07T14:30:33.833Z" title="更新于 2021-07-07 22:30:33">2021-07-07</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Writeup/">Writeup</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/offbynull/">offbynull</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/%E5%9B%BD%E8%B5%9B/">国赛</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/CICSN/">CICSN</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/%E6%A0%88%E8%BF%81%E7%A7%BB/">栈迁移</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/fini-array/">fini_array</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/64%E4%BD%8D%E9%9D%99%E6%80%81%E7%A8%8B%E5%BA%8F/">64位静态程序</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/%E9%9D%99%E6%80%81%E7%A8%8B%E5%BA%8F/">静态程序</a></span></div><div class="content">iNote漏洞点edit 功能当写入 chunk size 长度的数据时，会造成 off by null 

思路题目基于 libc2.27 ，仅有 off by null 一个漏洞。

填满 tcache 之后，将堆释放到 fastbin ，输入长字符串利用 scanf 触发 malloc 大堆块将 fastbin 整理到 unsortedbin ，泄露出 libc 地址
利用 offbynull 向前unlink合并将 prev_inuse 控制为 0 ，结合伪造 header 、offbynull 向后unlink制造堆重叠

输入长字符串利用 scanf 触发 malloc_consolidate ：
1234567891011121314151617181920#step0:unsortedbin泄露libc地址for i in range(8):    add(i,0x78)add(8,0x58)#后面offbynull构造0x110add(9,0x20)#后面offbynull构造0x110for i in list(range(8)):    delete(i)p.se ...</div></div></div><div class="recent-post-item"><div class="post_cover right_radius"><a href="/archives/feaa0d63/" title="2021 强网杯 Writeup">     <img class="post_bg" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="/img/default_cover1.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="2021 强网杯 Writeup"></a></div><div class="recent-post-info"><a class="article-title" href="/archives/feaa0d63/" title="2021 强网杯 Writeup">2021 强网杯 Writeup</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time class="post-meta-date-created" datetime="2021-06-14T15:32:26.000Z" title="发表于 2021-06-14 23:32:26">2021-06-14</time><span class="article-meta__separator">|</span><i class="fas fa-history"></i><span class="article-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2021-10-28T15:34:44.226Z" title="更新于 2021-10-28 23:34:44">2021-10-28</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Writeup/">Writeup</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/%E5%BC%BA%E7%BD%91%E6%9D%AF/">强网杯</a></span></div><div class="content">[强网先锋]no_output漏洞存在栈溢出：

思路远程存在 real_flag.txt 读入后 unk_804C080 是 0x3

在 read(0, buf, 0x30u); 输入 \x00 覆盖 unk_804C080 为 0x00 ，实现向 src 输入，输入对应内容进入 if 内

输入对应值后进入 if 内，配置了一个浮点数错误的 signal ：在发生致命的算术运算错误时发出， 不仅包括浮点运算错误， 还包括溢出及除数为0等其它所有的算术的错误。由于 v1 固定是 1 ，所以这种制造错误的方法 pass 。不一定要是被 0 除以。2 的补码 INT_MIN/-1 除法陷阱也行:
1-2147483648/-1




产生错误之后跳转运行栈溢出函数
EXP1234567891011121314151617181920212223242526272829303132333435363738394041424344454647from pwn import *context.log_level = &#x27;debug&#x27;context.terminal = [ ...</div></div></div><nav id="pagination"><div class="pagination"><a class="extend prev" rel="prev" href="/page/3/#content-inner"><i class="fas fa-chevron-left fa-fw"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/3/#content-inner">3</a><span class="page-number current">4</span><a class="page-number" href="/page/5/#content-inner">5</a><span class="space">&hellip;</span><a class="page-number" href="/page/16/#content-inner">16</a><a class="extend next" rel="next" href="/page/5/#content-inner"><i class="fas fa-chevron-right fa-fw"></i></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="/img/avatar.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">SkYe231</div><div class="author-info__description"></div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">152</div></a></div><div class="card-info-data-item is-center"><a href="/tags/"><div class="headline">标签</div><div class="length-num">188</div></a></div><div class="card-info-data-item is-center"><a href="/categories/"><div class="headline">分类</div><div class="length-num">19</div></a></div></div><div class="card-info-social-icons is-center"><a class="social-icon" href="mailto:skye231@foxmail.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a><a class="social-icon" href="https://www.mrskye.cn/atom.xml" target="_blank" title="RSS"><i class="fas fa-rss"></i></a><a class="social-icon" href="http://wpa.qq.com/msgrd?uin=910437231" target="_blank" title="QQ"><i class="iconfont icon-QQ"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>公告</span></div><div class="announcement_content">请修改默认公告</div></div><div class="sticky_layout"><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/archives/501bc79/" title="BUU Web Writeup"><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="/img/default_cover1.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="BUU Web Writeup"/></a><div class="content"><a class="title" href="/archives/501bc79/" title="BUU Web Writeup">BUU Web Writeup</a><time datetime="2022-01-19T07:14:06.230Z" title="更新于 2022-01-19 15:14:06">2022-01-19</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/archives/533bc7a3/" title="SQL注入"><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="/img/default_cover0.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="SQL注入"/></a><div class="content"><a class="title" href="/archives/533bc7a3/" title="SQL注入">SQL注入</a><time datetime="2022-01-19T07:12:03.233Z" title="更新于 2022-01-19 15:12:03">2022-01-19</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/archives/d3333ead/" title="反序列化"><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="/img/default_cover1.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="反序列化"/></a><div class="content"><a class="title" href="/archives/d3333ead/" title="反序列化">反序列化</a><time datetime="2022-01-18T15:08:53.536Z" title="更新于 2022-01-18 23:08:53">2022-01-18</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/archives/8c4c947e/" title="代码执行"><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="/img/default_cover4.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="代码执行"/></a><div class="content"><a class="title" href="/archives/8c4c947e/" title="代码执行">代码执行</a><time datetime="2022-01-17T17:06:21.285Z" title="更新于 2022-01-18 01:06:21">2022-01-18</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/archives/cf64b99a/" title="命令执行"><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="/img/default_cover0.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="命令执行"/></a><div class="content"><a class="title" href="/archives/cf64b99a/" title="命令执行">命令执行</a><time datetime="2022-01-16T17:06:55.982Z" title="更新于 2022-01-17 01:06:55">2022-01-17</time></div></div></div></div><div class="card-widget" id="card-newest-comments"><div class="item-headline"><i class="fas fa-comment-dots"></i><span>最新评论</span></div><div class="aside-list"><span>正在加载中...</span></div></div><div class="card-widget card-categories"><div class="item-headline">
            <i class="fas fa-folder-open"></i>
            <span>分类</span>
            <a class="card-more-btn" href="/categories/" title="查看更多">
    <i class="fas fa-angle-right"></i></a>
            </div>
            <ul class="card-category-list" id="aside-cat-list">
            <li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Crypto/"><span class="card-category-list-name">Crypto</span><span class="card-category-list-count">3</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/IOT/"><span class="card-category-list-name">IOT</span><span class="card-category-list-count">9</span></a><ul class="card-category-list child"><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/IOT/%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/"><span class="card-category-list-name">漏洞复现</span><span class="card-category-list-count">4</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/IOT/%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/"><span class="card-category-list-name">环境配置</span><span class="card-category-list-count">2</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/IOT/%E8%B5%84%E6%96%99/"><span class="card-category-list-name">资料</span><span class="card-category-list-count">1</span></a></li></ul></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/MISC/"><span class="card-category-list-name">MISC</span><span class="card-category-list-count">3</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/PWN/"><span class="card-category-list-name">PWN</span><span class="card-category-list-count">39</span></a><ul class="card-category-list child"><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/PWN/ARM/"><span class="card-category-list-name">ARM</span><span class="card-category-list-count">1</span></a></li></ul></li>
            </ul></div><div class="card-widget card-tags"><div class="item-headline"><i class="fas fa-tags"></i><span>标签</span></div><div class="card-tag-cloud"><a href="/tags/Dlink/" style="font-size: 1.15em; color: rgb(64, 123, 180)">Dlink</a><a href="/tags/NCTF/" style="font-size: 1.15em; color: rgb(135, 150, 68)">NCTF</a><a href="/tags/glibc2-32/" style="font-size: 1.15em; color: rgb(186, 142, 181)">glibc2.32</a><a href="/tags/UAF/" style="font-size: 1.25em; color: rgb(172, 31, 29)">UAF</a><a href="/tags/ijctf/" style="font-size: 1.15em; color: rgb(65, 175, 19)">ijctf</a><a href="/tags/%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2/" style="font-size: 1.25em; color: rgb(176, 134, 160)">格式化字符串</a><a href="/tags/NSSCCTF/" style="font-size: 1.15em; color: rgb(14, 41, 191)">NSSCCTF</a><a href="/tags/%E5%B9%BF%E4%B8%9C%E7%9C%81%E5%BC%BA%E7%BD%91%E6%9D%AF/" style="font-size: 1.15em; color: rgb(148, 24, 146)">广东省强网杯</a><a href="/tags/%E7%BE%8A%E5%9F%8E%E6%9D%AF/" style="font-size: 1.25em; color: rgb(84, 89, 72)">羊城杯</a><a href="/tags/%E6%B2%99%E7%9B%92%E5%A0%86/" style="font-size: 1.45em; color: rgb(20, 159, 156)">沙盒堆</a><a href="/tags/%E6%B9%96%E6%B9%98%E6%9D%AF/" style="font-size: 1.25em; color: rgb(24, 187, 169)">湖湘杯</a><a href="/tags/%E9%95%BF%E5%AE%89%E6%9D%AF/" style="font-size: 1.25em; color: rgb(179, 179, 32)">长安杯</a><a href="/tags/Handsome/" style="font-size: 1.15em; color: rgb(95, 35, 77)">Handsome</a><a href="/tags/%E7%BE%8E%E5%8C%96/" style="font-size: 1.15em; color: rgb(164, 58, 170)">美化</a><a href="/tags/typecho/" style="font-size: 1.15em; color: rgb(129, 91, 64)">typecho</a><a href="/tags/WordPress/" style="font-size: 1.15em; color: rgb(48, 92, 142)">WordPress</a><a href="/tags/%E9%82%AE%E4%BB%B6%E9%80%9A%E7%9F%A5/" style="font-size: 1.15em; color: rgb(142, 39, 68)">邮件通知</a><a href="/tags/%E8%A5%BF%E6%B9%96%E8%AE%BA%E5%89%91/" style="font-size: 1.15em; color: rgb(80, 63, 50)">西湖论剑</a><a href="/tags/house-of-banana/" style="font-size: 1.15em; color: rgb(100, 61, 117)">house of banana</a><a href="/tags/largebin-attack/" style="font-size: 1.15em; color: rgb(83, 117, 2)">largebin attack</a><a href="/tags/ida/" style="font-size: 1.25em; color: rgb(138, 91, 38)">ida</a><a href="/tags/grep/" style="font-size: 1.15em; color: rgb(128, 75, 189)">grep</a><a href="/tags/nfc/" style="font-size: 1.15em; color: rgb(141, 63, 181)">nfc</a><a href="/tags/PN532/" style="font-size: 1.15em; color: rgb(125, 86, 74)">PN532</a><a href="/tags/EOF/" style="font-size: 1.15em; color: rgb(192, 119, 8)">EOF</a><a href="/tags/offbynull/" style="font-size: 1.25em; color: rgb(133, 194, 64)">offbynull</a><a href="/tags/scanf/" style="font-size: 1.15em; color: rgb(27, 63, 106)">scanf</a><a href="/tags/unlink/" style="font-size: 1.35em; color: rgb(9, 140, 178)">unlink</a><a href="/tags/%E5%BC%BA%E7%BD%91%E6%9D%AF/" style="font-size: 1.15em; color: rgb(199, 7, 138)">强网杯</a><a href="/tags/%E4%BA%A4%E9%80%9A%E7%81%AF/" style="font-size: 1.15em; color: rgb(24, 166, 175)">交通灯</a><a href="/tags/%E5%8D%95%E7%89%87%E6%9C%BA/" style="font-size: 1.15em; color: rgb(144, 106, 74)">单片机</a><a href="/tags/C51/" style="font-size: 1.15em; color: rgb(142, 146, 92)">C51</a><a href="/tags/steam/" style="font-size: 1.15em; color: rgb(138, 84, 1)">steam</a><a href="/tags/asf/" style="font-size: 1.15em; color: rgb(108, 41, 38)">asf</a><a href="/tags/Steam%E4%BA%91%E6%8C%82%E5%8D%A1/" style="font-size: 1.15em; color: rgb(192, 83, 30)">Steam云挂卡</a><a href="/tags/%E9%B9%A4%E5%9F%8E%E6%9D%AF/" style="font-size: 1.15em; color: rgb(115, 33, 50)">鹤城杯</a><a href="/tags/%E9%9A%A7%E9%81%93/" style="font-size: 1.15em; color: rgb(93, 162, 187)">隧道</a><a href="/tags/wireguard/" style="font-size: 1.15em; color: rgb(64, 150, 143)">wireguard</a><a href="/tags/%E4%B8%AD%E8%BD%AC%E6%B5%81%E9%87%8F/" style="font-size: 1.15em; color: rgb(152, 116, 196)">中转流量</a><a href="/tags/IPLC/" style="font-size: 1.15em; color: rgb(160, 161, 154)">IPLC</a></div></div><div class="card-widget card-archives"><div class="item-headline"><i class="fas fa-archive"></i><span>归档</span><a class="card-more-btn" href="/archives/" title="查看更多">
    <i class="fas fa-angle-right"></i></a></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2022/01/"><span class="card-archive-list-date">一月 2022</span><span class="card-archive-list-count">4</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2021/12/"><span class="card-archive-list-date">十二月 2021</span><span class="card-archive-list-count">10</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2021/11/"><span class="card-archive-list-date">十一月 2021</span><span class="card-archive-list-count">3</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2021/10/"><span class="card-archive-list-date">十月 2021</span><span class="card-archive-list-count">4</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2021/09/"><span class="card-archive-list-date">九月 2021</span><span class="card-archive-list-count">8</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2021/08/"><span class="card-archive-list-date">八月 2021</span><span class="card-archive-list-count">4</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2021/07/"><span class="card-archive-list-date">七月 2021</span><span class="card-archive-list-count">3</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2021/06/"><span class="card-archive-list-date">六月 2021</span><span class="card-archive-list-count">5</span></a></li></ul></div><div class="card-widget card-webinfo"><div class="item-headline"><i class="fas fa-chart-line"></i><span>网站资讯</span></div><div class="webinfo"><div class="webinfo-item"><div class="item-name">文章数目 :</div><div class="item-count">152</div></div><div class="webinfo-item"><div class="item-name">已运行时间 :</div><div class="item-count" id="runtimeshow" data-publishDate="2019-05-31T16:00:00.000Z"></div></div><div class="webinfo-item"><div class="item-name">本站总字数 :</div><div class="item-count">304.1k</div></div><div class="webinfo-item"><div class="item-name">本站访客数 :</div><div class="item-count" id="busuanzi_value_site_uv"></div></div><div class="webinfo-item"><div class="item-name">本站总访问量 :</div><div class="item-count" id="busuanzi_value_site_pv"></div></div><div class="webinfo-item"><div class="item-name">最后更新时间 :</div><div class="item-count" id="last-push-date" data-lastPushDate="2022-01-19T07:14:29.505Z"></div></div></div></div></div></div></main><footer id="footer" style="background-image: url('/img/background.jpg')"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2022 By SkYe231</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text"><a href="https://cloud.tencent.com/product/wh?from=12331" target="_blank">Hosted BY 云开发 Cloudbase</a>&nbsp;|&nbsp;<a href="https://www.upyun.com/?utm_source=lianmeng&utm_medium=referral" target="_blank"><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://mrskye.cn-gd.ufileos.com/img/2020-07-01-lGwrnPz3GuV4odmM.png" align="top" style="width:48px"></a><br /><div class="github-badge"><a rel="license" href="http://beian.miit.gov.cn/" target="_blank" title="粤ICP备20056619号"><span class="badge-subject">粤ICP备</span><span class="badge-value bg-black">20056619号</span></a></div></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="font-plus" type="button" title="放大字体"><i class="fas fa-plus"></i></button><button id="font-minus" type="button" title="缩小字体"><i class="fas fa-minus"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div></div><hr/><div id="local-search-results"></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.autoSpacingPage()
  else {
    getScript('https://cdn.jsdelivr.net/npm/pangu/dist/browser/pangu.min.js')
      .then(() => {
        pangu.autoSpacingPage()
      })
  }
}

function panguInit () {
  if (false){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><script src="/js/search/local-search.js"></script><script>var preloader = {
  endLoading: () => {
    document.body.style.overflow = 'auto';
    document.getElementById('loading-box').classList.add("loaded")
  },
  initLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.remove("loaded")

  }
}
window.addEventListener('load',preloader.endLoading())</script><div class="js-pjax"><script>function subtitleType () {
  fetch('https://v1.hitokoto.cn')
    .then(response => response.json())
    .then(data => {
      if (true) {
        var from = '出自 ' + data.from
        var sub = "".length == 0 ? new Array() : "".split(',')
        var both = sub.unshift(data.hitokoto, from)
        var typed = new Typed('#subtitle', {
          strings: sub,
          startDelay: 300,
          typeSpeed: 150,
          loop: true,
          backSpeed: 50,
        })
      } else {
        document.getElementById('subtitle').innerHTML = data.hitokoto
      }
    })
}

if (true) {
  if (typeof Typed === 'function') {
    subtitleType()
  } else {
    getScript('https://cdn.jsdelivr.net/npm/typed.js/lib/typed.min.js').then(subtitleType)
  }
} else {
  subtitleType()
}
</script><script>if (document.getElementsByClassName('mermaid').length) {
  if (window.mermaidJsLoad) mermaid.init()
  else {
    getScript('https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js').then(() => {
      window.mermaidJsLoad = true
      mermaid.initialize({
        theme: 'default',
      })
      false && mermaid.init()
    })
  }
}</script></div><script defer="defer" id="ribbon" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-ribbon.min.js" size="150" alpha="0.6" zIndex="-1" mobile="false" data-click="false"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = false;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><script id="click-show-text" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/click-show-text.min.js" data-mobile="false" data-text="富强,民主,文明,和谐,自由,平等,公正,法治,爱国,敬业,诚信,友善" data-fontsize="15px" data-random="true" async="async"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>