<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>SkYe231 Blog - 笔记📝</title><meta name="author" content="SkYe231"><meta name="copyright" content="SkYe231"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta property="og:type" content="website">
<meta property="og:title" content="SkYe231 Blog">
<meta property="og:url" content="https://www.mrskye.cn/index.html">
<meta property="og:site_name" content="SkYe231 Blog">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://www.mrskye.cn/img/avatar.png">
<meta property="article:author" content="SkYe231">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://www.mrskye.cn/img/avatar.png"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://www.mrskye.cn/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//www.google-analytics.com" crossorigin=""/><link rel="preconnect" href="//hm.baidu.com"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload="this.media='all'"><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?8184ae9371af7cedfa47d27c247e16b8";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script><script async="async" src="https://www.googletagmanager.com/gtag/js?id=UA-154693872-1"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-154693872-1');
</script><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: {"limitDay":500,"position":"top","messagePrev":"这篇文章距离上次更新已经","messageNext":"天，内容可能已经过时了。"},
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: true,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"limitCount":200,"languages":{"author":"作者: SkYe231","link":"链接: ","source":"来源: SkYe231 Blog","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#121212","position":"bottom-left"},
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: true,
  islazyload: true,
  isanchor: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'SkYe231 Blog',
  isPost: false,
  isHome: true,
  isHighlightShrink: false,
  isToc: false,
  postUpdate: '2021-07-28 11:34:11'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const fontSizeVal = saveToLocal.get('global-font-size')
    if (fontSizeVal !== undefined) {
      document.documentElement.style.setProperty('--global-font-size', fontSizeVal + 'px')
    }
    })(window)</script><link rel="stylesheet" href="//at.alicdn.com/t/font_2567732_2yo06945456.css"><meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/atom.xml" title="SkYe231 Blog" type="application/atom+xml">
</head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="author-avatar"><img class="avatar-img" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="/img/avatar.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">文章</div><div class="length-num">115</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">标签</div><div class="length-num">160</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">分类</div><div class="length-num">16</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 目录</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-wrench"></i><span> 工具</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" target="_blank" rel="noopener" href="http://mrskye.gitee.io/cyberchef/"><i class="fa-fw fas fa-key"></i><span> cyberchef</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友情链接</span></a></div><div class="menus_item"><a class="site-page" target="_blank" rel="noopener" href="https://travellings.now.sh/"><i class="fa-fw fas fa-subway"></i><span> 开往</span></a></div><div class="menus_item"><a class="site-page" href="/atom.xml"><i class="fa-fw fas fa-rss"></i><span> RSS</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div></div></div><div class="page" id="body-wrap"><header class="full_page" id="page-header" style="background-image: url('/img/background.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">SkYe231 Blog</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 目录</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-wrench"></i><span> 工具</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" target="_blank" rel="noopener" href="http://mrskye.gitee.io/cyberchef/"><i class="fa-fw fas fa-key"></i><span> cyberchef</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友情链接</span></a></div><div class="menus_item"><a class="site-page" target="_blank" rel="noopener" href="https://travellings.now.sh/"><i class="fa-fw fas fa-subway"></i><span> 开往</span></a></div><div class="menus_item"><a class="site-page" href="/atom.xml"><i class="fa-fw fas fa-rss"></i><span> RSS</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="site-info"><h1 id="site-title">SkYe231 Blog</h1><div id="site-subtitle"><span id="subtitle"></span></div><div id="site_social_icons"><a class="social-icon" href="mailto:skye231@foxmail.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a><a class="social-icon" href="https://www.mrskye.cn/atom.xml" target="_blank" title="RSS"><i class="fas fa-rss"></i></a><a class="social-icon" href="http://wpa.qq.com/msgrd?uin=910437231" target="_blank" title="QQ"><i class="iconfont icon-QQ"></i></a></div></div><div id="scroll-down"><i class="fas fa-angle-down scroll-down-effects"></i></div></header><main class="layout" id="content-inner"><div class="recent-posts" id="recent-posts"><div class="recent-post-item"><div class="post_cover left_radius"><a href="/archives/887a5205/" title="2021红帽杯决赛Writeup">     <img class="post_bg" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="/img/default_cover2.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="2021红帽杯决赛Writeup"></a></div><div class="recent-post-info"><a class="article-title" href="/archives/887a5205/" title="2021红帽杯决赛Writeup">2021红帽杯决赛Writeup</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time class="post-meta-date-created" datetime="2021-07-27T06:36:37.000Z" title="发表于 2021-07-27 14:36:37">2021-07-27</time><span class="article-meta__separator">|</span><i class="fas fa-history"></i><span class="article-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2021-07-28T02:10:04.698Z" title="更新于 2021-07-28 10:10:04">2021-07-28</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Writeup/">Writeup</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/Rust/">Rust</a></span></div><div class="content">Ruuuuust程序分析rust 语言写的程序，除了 canary 以外保护全开：

rust 写的程序逆向分析会发现多了很多分支，通过动态调试辅助定位实现功能的函数。
在输入选择时中断程序，通过 gcc breakpoint 查看上层调用函数的地址，定位到 main 函数的地址为： 0x7C10
109 行开始就是 switch 判断进入对应功能的实现函数，switch 判断是输入值 +1 ：

set_name 和 show_name 两个功能啥问题，name size 限制小于 0x10 ，输入函数在 235 行的 read 函数。show name 的时候用 memcpy 复制到另外一个栈变量，然后再进行输出。
talk 询问 size 时，限制不大于 0xf8 ：

输入函数用的还是 235 行 read ，向栈上写入 0xb8 已经造成溢出：

退出程序时：

利用思路rust 不能通过表调用函数，需要利用程序中的 call 片段。程序中有两种调用形式：

直接 call write


将 write 地址写入寄存器，然后 call 寄存器



栈溢出构造出一个 rea ...</div></div></div><div class="recent-post-item"><div class="post_cover right_radius"><a href="/archives/562e05a9/" title="2021卫生CTFWritreup">     <img class="post_bg" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="/img/default_cover2.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="2021卫生CTFWritreup"></a></div><div class="recent-post-info"><a class="article-title" href="/archives/562e05a9/" title="2021卫生CTFWritreup">2021卫生CTFWritreup</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time class="post-meta-date-created" datetime="2021-07-26T01:08:30.000Z" title="发表于 2021-07-26 09:08:30">2021-07-26</time><span class="article-meta__separator">|</span><i class="fas fa-history"></i><span class="article-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2021-07-28T03:29:39.832Z" title="更新于 2021-07-28 11:29:39">2021-07-28</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Writeup/">Writeup</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/arm%EF%BC%8CUAF/">arm，UAF</a></span></div><div class="content">notebookadd 构造固定大小 0x108 的堆块，用下一个堆块的 prev_size 来构造链表，全局标志位记录链头的地址。问题在于 free 的没有重新调整找个链表的结构，依然保持着相同的链表结构。利用 show 可以将整个链表打印出来，需要是要调整全局指针和 unsortedbin 的关系，因为 free 进入unsortedbin 之后，下个堆的 prev_size 会被修改为 0x110 ，导致 show 的时候地址不可读而报错退出。

EXP12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758from pwn import *context.log_level = &#x27;debug&#x27;#p = process(&quot;./chall&quot;)p = process(&quot;./chall&quot;, env=&#123;&quot;LD_PRELOAD&quot;:&quot;./ ...</div></div></div><div class="recent-post-item"><div class="post_cover left_radius"><a href="/archives/25a80e2a/" title="2021国赛华北赛区决赛Writeup">     <img class="post_bg" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="/img/default_cover5.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="2021国赛华北赛区决赛Writeup"></a></div><div class="recent-post-info"><a class="article-title" href="/archives/25a80e2a/" title="2021国赛华北赛区决赛Writeup">2021国赛华北赛区决赛Writeup</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time class="post-meta-date-created" datetime="2021-06-24T06:21:23.000Z" title="发表于 2021-06-24 14:21:23">2021-06-24</time><span class="article-meta__separator">|</span><i class="fas fa-history"></i><span class="article-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2021-06-26T09:54:43.329Z" title="更新于 2021-06-26 17:54:43">2021-06-26</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Writeup/">Writeup</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/%E5%9B%BD%E8%B5%9B/">国赛</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/CICSN/">CICSN</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/%E6%A0%88%E8%BF%81%E7%A7%BB/">栈迁移</a></span></div><div class="content">Pwn_checkinglibc 2.32 影响不大，没有涉及相关的防护措施，也给了 ld ，更好模拟远程换下加载方式：
1p = process([&quot;./ld-2.32.so&quot;, &quot;./pwn&quot;], env=&#123;&quot;LD_PRELOAD&quot;:&quot;./libc.so.6&quot;&#125;)

开局给了 text 段的地址，PIE 等于没开。然后可以想 bss 段写入非常长字符串，这里写入的应该是 ropchain ，因为这段空间没有执行权限。接着就是有一个栈溢出，溢出长度刚好覆盖 rip ，结合前面往 bss 段写入内容，判断是栈迁移。

elf 中没有足够的函数和 gadget ，决定第一步先用 puts 泄露出 libc 基地址，然后写入第二次的 ropchain ，设想构造之前遇到过的栈迁移的结构：

1234payload = &#x27;a&#x27;*0x800#&#x27;a&#x27;*(0x800-8)+p64(bss+0x840-8)payload += p64(pop_rdi_ret)+ ...</div></div></div><div class="recent-post-item"><div class="post_cover right_radius"><a href="/archives/3cd31180/" title="仅offbynull攻击总结">     <img class="post_bg" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="/img/default_cover4.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="仅offbynull攻击总结"></a></div><div class="recent-post-info"><a class="article-title" href="/archives/3cd31180/" title="仅offbynull攻击总结">仅offbynull攻击总结</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time class="post-meta-date-created" datetime="2021-06-21T15:38:01.000Z" title="发表于 2021-06-21 23:38:01">2021-06-21</time><span class="article-meta__separator">|</span><i class="fas fa-history"></i><span class="article-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2021-06-23T15:31:53.064Z" title="更新于 2021-06-23 23:31:53">2021-06-23</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/PWN/">PWN</a><i class="fas fa-angle-right"></i><a class="article-meta__categories" href="/categories/PWN/%E6%80%BB%E7%BB%93/">总结</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/offbynull/">offbynull</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/scanf/">scanf</a></span></div><div class="content">特征标志
仅存在 off by null 漏洞

不能申请大于 fastbin 的堆块（可以申请也能用这种方法）
如果能申请大于 fastbin 的堆块，申请 0x101 覆盖成 0x100 并控制 prev_size ，就能向低地址的堆块合并

存在 scanf （或其他将 fastbin 放置到 unsortedbin 的途径）
单纯 offbynull 无法在 fastbin 中利用，需要结合 unsortedbin


适用glibc版本无论有无 tcache ，都能适用。
存在 tcache 则需要先将对应 size 填满，才能放入 fastbin 。
攻击效果造成堆重叠（chunk extend），进而控制各类 bin 中的指针，完成 getshell
原理难点在于：fastbin 堆块的 size 长度为 1 个字节（如：0xf0），如果 offbynull 覆盖 prev_inuse 时，会将整个 size 覆盖为 0x00 ，而这会引起报错。
解决思路：

利用 unsortedbin 形成时，会将其所在的前一个（高地址）非 topchunk 的堆块 prev_siz ...</div></div></div><div class="recent-post-item"><div class="post_cover left_radius"><a href="/archives/ba728db4/" title="2021国赛华南赛区决赛Writeup">     <img class="post_bg" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="/img/default_cover3.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="2021国赛华南赛区决赛Writeup"></a></div><div class="recent-post-info"><a class="article-title" href="/archives/ba728db4/" title="2021国赛华南赛区决赛Writeup">2021国赛华南赛区决赛Writeup</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time class="post-meta-date-created" datetime="2021-06-20T11:57:14.000Z" title="发表于 2021-06-20 19:57:14">2021-06-20</time><span class="article-meta__separator">|</span><i class="fas fa-history"></i><span class="article-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2021-07-07T14:30:33.833Z" title="更新于 2021-07-07 22:30:33">2021-07-07</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Writeup/">Writeup</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/offbynull/">offbynull</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/%E5%9B%BD%E8%B5%9B/">国赛</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/CICSN/">CICSN</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/%E6%A0%88%E8%BF%81%E7%A7%BB/">栈迁移</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/fini-array/">fini_array</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/64%E4%BD%8D%E9%9D%99%E6%80%81%E7%A8%8B%E5%BA%8F/">64位静态程序</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/%E9%9D%99%E6%80%81%E7%A8%8B%E5%BA%8F/">静态程序</a></span></div><div class="content">iNote漏洞点edit 功能当写入 chunk size 长度的数据时，会造成 off by null 

思路题目基于 libc2.27 ，仅有 off by null 一个漏洞。

填满 tcache 之后，将堆释放到 fastbin ，输入长字符串利用 scanf 触发 malloc 大堆块将 fastbin 整理到 unsortedbin ，泄露出 libc 地址
利用 offbynull 向前unlink合并将 prev_inuse 控制为 0 ，结合伪造 header 、offbynull 向后unlink制造堆重叠

输入长字符串利用 scanf 触发 malloc_consolidate ：
1234567891011121314151617181920#step0:unsortedbin泄露libc地址for i in range(8):    add(i,0x78)add(8,0x58)#后面offbynull构造0x110add(9,0x20)#后面offbynull构造0x110for i in list(range(8)):    delete(i)p.se ...</div></div></div><div class="recent-post-item"><div class="post_cover right_radius"><a href="/archives/c8c111be/" title="2021蓝帽杯华南赛区决赛Writeup">     <img class="post_bg" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="/img/default_cover0.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="2021蓝帽杯华南赛区决赛Writeup"></a></div><div class="recent-post-info"><a class="article-title" href="/archives/c8c111be/" title="2021蓝帽杯华南赛区决赛Writeup">2021蓝帽杯华南赛区决赛Writeup</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time class="post-meta-date-created" datetime="2021-06-04T09:53:35.000Z" title="发表于 2021-06-04 17:53:35">2021-06-04</time><span class="article-meta__separator">|</span><i class="fas fa-history"></i><span class="article-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2021-06-26T09:54:43.330Z" title="更新于 2021-06-26 17:54:43">2021-06-26</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Writeup/">Writeup</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/%E8%93%9D%E5%B8%BD%E6%9D%AF/">蓝帽杯</a></span></div><div class="content">coverMain 函数有一个任意地址写入 1 字节漏洞：

同时程序留有后门函数：

利用任意地址写入一字节，修改 puts plt 表 jmp 部分汇编，跳转到 system 函数：


EXP123456789101112131415161718192021from pwn import *context.log_level=&#x27;debug&#x27;context.terminal=[&#x27;tmux&#x27;,&#x27;sp&#x27;,&#x27;-h&#x27;]# p = process(&quot;./pwn&quot;)p = remote(&quot;118.190.62.234&quot;,12435)elf = ELF(&quot;./pwn&quot;)libc = ELF(&quot;/lib/i386-linux-gnu/libc.so.6&quot;)# gdb.attach(p,&quot;b *0x0804875D&quot;)# raw_input()p.recvuntil(&quot;Try use a bullet to pw ...</div></div></div><div class="recent-post-item"><div class="post_cover left_radius"><a href="/archives/31fc9d87/" title="pwntools发送eof信号">     <img class="post_bg" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="/img/default_cover3.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="pwntools发送eof信号"></a></div><div class="recent-post-info"><a class="article-title" href="/archives/31fc9d87/" title="pwntools发送eof信号">pwntools发送eof信号</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time class="post-meta-date-created" datetime="2021-05-27T16:24:58.000Z" title="发表于 2021-05-28 00:24:58">2021-05-28</time><span class="article-meta__separator">|</span><i class="fas fa-history"></i><span class="article-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2021-05-27T16:49:06.554Z" title="更新于 2021-05-28 00:49:06">2021-05-28</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/PWN/">PWN</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/EOF/">EOF</a></span></div><div class="content">做题目遇到的两种 eof 信号需求情况：

发送 eof 之后，后续不需要继续输入（vnctf-White-Give-Flag）
发送 eof 之后，后续还需要继续输入（mtctf-blind）

eof 发送后继续输入不用 mtctf-blind 做例子，因为利用 eof 绕过第一层之后，由于题目其他方面而无法 getshell ，用一个 demo 例子（来源）代替：
1234567891011121314#include &lt;stdio.h&gt;#include &lt;stdlib.h&gt;#include &lt;string.h&gt;int main(void) &#123;   char buf[24];   while(1) &#123;      if(read(0,buf,16)==0) &#123;         break;      &#125;   &#125;   read(0,buf,1000);   return 0;&#125;

题目要求第一个 read 返回值为 0 ，也就是输入字符串长度为 0 ，才能到达下面的 read 栈溢出漏洞。 ...</div></div></div><div class="recent-post-item"><div class="post_cover right_radius"><a href="/archives/1499f4e1/" title="2021MTCTFWriteup">     <img class="post_bg" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="/img/default_cover3.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="2021MTCTFWriteup"></a></div><div class="recent-post-info"><a class="article-title" href="/archives/1499f4e1/" title="2021MTCTFWriteup">2021MTCTFWriteup</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time class="post-meta-date-created" datetime="2021-05-26T08:24:33.000Z" title="发表于 2021-05-26 16:24:33">2021-05-26</time><span class="article-meta__separator">|</span><i class="fas fa-history"></i><span class="article-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2021-07-28T02:10:27.151Z" title="更新于 2021-07-28 10:10:27">2021-07-28</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Writeup/">Writeup</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/%E6%B2%99%E7%9B%92%E5%A0%86/">沙盒堆</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/MTCTF/">MTCTF</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/%E5%8A%AB%E6%8C%81exit/">劫持exit</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/%E6%97%A0%E8%BE%93%E5%87%BA%E5%A0%86%E9%A2%98/">无输出堆题</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/%E5%8A%AB%E6%8C%81stdout%E6%B3%84%E9%9C%B2libc%E5%9C%B0%E5%9D%80/">劫持stdout泄露libc地址</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/setcontext/">setcontext</a></span></div><div class="content">baby_focalglibc 2.31 ，没有 PIE ，没有输出功能，开沙盒的堆溢出：

没有输出功能思路基本都是攻击 stdout 泄露出 libc 地址，这条题目分配函数用的是 calloc ，相当于没有 tcache 存在的，攻击思路和 glibc 2.23 一样。然后就是利用 free_hook 栈迁移到堆上的 orw 。
思路
填满 tcache 之后，利用堆溢出形成堆重叠，形成两个指向同一个地址的指针。注意需要在第一个 unsortedbin 前面布置一个堆，用来修改 size 来绕过保护。

两个同一地址的指针，在 fastbin 写入 main_arena_xx 地址，爆破 1/16 到 stdout 上方，利用错位构造出符合 fastbin 的 size 位。

这篇文章末尾中有提及：http://blog.eonew.cn/archives/1190


修复 unsortedbin 恢复分配释放功能。利用堆溢出劫持 fastbin fd 指针将堆分配到堆指针数组（需要提前布置 size 绕过保护），实现任意地址写。

将 free_hook 劫持为 puts  ...</div></div></div><div class="recent-post-item"><div class="post_cover left_radius"><a href="/archives/e150a036/" title="e150a036">     <img class="post_bg" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="/img/default_cover3.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="e150a036"></a></div><div class="recent-post-info"><a class="article-title" href="/archives/e150a036/" title="e150a036">e150a036</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time class="post-meta-date-created" datetime="2021-05-24T15:12:15.000Z" title="发表于 2021-05-24 23:12:15">2021-05-24</time><span class="article-meta__separator">|</span><i class="fas fa-history"></i><span class="article-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2021-06-15T17:02:03.688Z" title="更新于 2021-06-16 01:02:03">2021-06-16</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Writeup/">Writeup</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5/">模板注入</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/SSTI/">SSTI</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/flask/">flask</a></span></div><div class="content">
  5cef23f373e591f73b0780f44e533ed0d3ed819ed94539aacbd49d448d83d203c86138188432ed081fb96647b11f4e3a368dbff21a107c0bf56a84e883b9e9e33008f6937bc89ddf2c43515884639c17b16be8fc8d7c60ab3918a7666f8afbdfd6ef22afa6448ec5230e4cbdb205b443dc1dce78bc1f81489eb2b8689922cc7ffcfa01b6870f03609a33ebed6664c0c9c091c5067672323ad3d5093313f6da15edc0464f67f35418be11e4d2bd27518f430de355636dfb2ad3ea81d4b2c0892aaa2a5f82c5966cbfdc30f29fb4152022511dae302e9ee3fc12b9589ca31fd55efaf2500ada4f88ae175f93a3366819c72dbf1cc7ddf26ebfa ...</div></div></div><div class="recent-post-item"><div class="post_cover right_radius"><a href="/archives/c8352f42/" title="第一届广东省大学生网络安全攻防大赛PWN Writeup">     <img class="post_bg" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="/img/default_cover1.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="第一届广东省大学生网络安全攻防大赛PWN Writeup"></a></div><div class="recent-post-info"><a class="article-title" href="/archives/c8352f42/" title="第一届广东省大学生网络安全攻防大赛PWN Writeup">第一届广东省大学生网络安全攻防大赛PWN Writeup</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time class="post-meta-date-created" datetime="2021-05-24T08:17:17.000Z" title="发表于 2021-05-24 16:17:17">2021-05-24</time><span class="article-meta__separator">|</span><i class="fas fa-history"></i><span class="article-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2021-05-24T09:08:16.130Z" title="更新于 2021-05-24 17:08:16">2021-05-24</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Writeup/">Writeup</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/%E6%97%A0%E8%BE%93%E5%87%BA%E5%A0%86%E9%A2%98/">无输出堆题</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/%E5%8A%AB%E6%8C%81stdout%E6%B3%84%E9%9C%B2libc%E5%9C%B0%E5%9D%80/">劫持stdout泄露libc地址</a><span class="article-meta__link">•</span><a class="article-meta__tags" href="/tags/%E7%9C%81%E8%B5%9B/">省赛</a></span></div><div class="content">
两个题目都是无输出堆题，最近一次比赛在 nepctf 遇到：https://www.mrskye.cn/archives/bdb75c49/#sooooeasy
思路方法概述：https://www.jianshu.com/p/fe28639e406e

BabyNote题目是基于 glibc 2.31 的菜单堆题。
漏洞出现在 free 之后没有置零指针导致的 UAF ：

程序没有输出函数，倒是有一个提示的函数 gift 函数，输出堆地址最低两个字节，没用明白，到最后也不关他的事情。
思路：

利用 tcache double 和 scanf 输出长字符串触发 malloc_consolidate 获取 main_arena 地址

爆破倒数第四个数字，将堆分配到 stdout 结构体上，修改 flag 和 write_base 地址泄露出 libc 地址

利用 tcache dup get shell


遇到的问题就是直接之前 libc 2.23 的 payload 去打的话没有回显出 libc 地址，原来的 payload ：
1p64(0x0FBAD1887) +p64 ...</div></div></div><nav id="pagination"><div class="pagination"><span class="page-number current">1</span><a class="page-number" href="/page/2/#content-inner">2</a><span class="space">&hellip;</span><a class="page-number" href="/page/12/#content-inner">12</a><a class="extend next" rel="next" href="/page/2/#content-inner"><i class="fas fa-chevron-right fa-fw"></i></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-info-avatar is-center"><img class="avatar-img" src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="/img/avatar.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/><div class="author-info__name">SkYe231</div><div class="author-info__description"></div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">115</div></a></div><div class="card-info-data-item is-center"><a href="/tags/"><div class="headline">标签</div><div class="length-num">160</div></a></div><div class="card-info-data-item is-center"><a href="/categories/"><div class="headline">分类</div><div class="length-num">16</div></a></div></div><div class="card-info-social-icons is-center"><a class="social-icon" href="mailto:skye231@foxmail.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a><a class="social-icon" href="https://www.mrskye.cn/atom.xml" target="_blank" title="RSS"><i class="fas fa-rss"></i></a><a class="social-icon" href="http://wpa.qq.com/msgrd?uin=910437231" target="_blank" title="QQ"><i class="iconfont icon-QQ"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>公告</span></div><div class="announcement_content">请修改默认公告</div></div><div class="sticky_layout"><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/archives/562e05a9/" title="2021卫生CTFWritreup"><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="/img/default_cover2.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="2021卫生CTFWritreup"/></a><div class="content"><a class="title" href="/archives/562e05a9/" title="2021卫生CTFWritreup">2021卫生CTFWritreup</a><time datetime="2021-07-28T03:29:39.832Z" title="更新于 2021-07-28 11:29:39">2021-07-28</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/archives/1499f4e1/" title="2021MTCTFWriteup"><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="/img/default_cover3.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="2021MTCTFWriteup"/></a><div class="content"><a class="title" href="/archives/1499f4e1/" title="2021MTCTFWriteup">2021MTCTFWriteup</a><time datetime="2021-07-28T02:10:27.151Z" title="更新于 2021-07-28 10:10:27">2021-07-28</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/archives/887a5205/" title="2021红帽杯决赛Writeup"><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="/img/default_cover2.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="2021红帽杯决赛Writeup"/></a><div class="content"><a class="title" href="/archives/887a5205/" title="2021红帽杯决赛Writeup">2021红帽杯决赛Writeup</a><time datetime="2021-07-28T02:10:04.698Z" title="更新于 2021-07-28 10:10:04">2021-07-28</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/archives/ba728db4/" title="2021国赛华南赛区决赛Writeup"><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="/img/default_cover3.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="2021国赛华南赛区决赛Writeup"/></a><div class="content"><a class="title" href="/archives/ba728db4/" title="2021国赛华南赛区决赛Writeup">2021国赛华南赛区决赛Writeup</a><time datetime="2021-07-07T14:30:33.833Z" title="更新于 2021-07-07 22:30:33">2021-07-07</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/archives/c8c111be/" title="2021蓝帽杯华南赛区决赛Writeup"><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="/img/default_cover0.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="2021蓝帽杯华南赛区决赛Writeup"/></a><div class="content"><a class="title" href="/archives/c8c111be/" title="2021蓝帽杯华南赛区决赛Writeup">2021蓝帽杯华南赛区决赛Writeup</a><time datetime="2021-06-26T09:54:43.330Z" title="更新于 2021-06-26 17:54:43">2021-06-26</time></div></div></div></div><div class="card-widget" id="card-newest-comments"><div class="item-headline"><i class="fas fa-bolt"></i><span>最新评论</span></div><div class="aside-list"><span>正在加载中...</span></div></div><div class="card-widget card-categories"><div class="item-headline">
            <i class="fas fa-folder-open"></i>
            <span>分类</span>
            <a class="card-more-btn" href="/categories/" title="查看更多">
    <i class="fas fa-angle-right"></i></a>
            </div>
            <ul class="card-category-list" id="aside-cat-list">
            <li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Crypto/"><span class="card-category-list-name">Crypto</span><span class="card-category-list-count">3</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/IOT/"><span class="card-category-list-name">IOT</span><span class="card-category-list-count">9</span></a><ul class="card-category-list child"><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/IOT/%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/"><span class="card-category-list-name">漏洞复现</span><span class="card-category-list-count">4</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/IOT/%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/"><span class="card-category-list-name">环境配置</span><span class="card-category-list-count">2</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/IOT/%E8%B5%84%E6%96%99/"><span class="card-category-list-name">资料</span><span class="card-category-list-count">1</span></a></li></ul></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/MISC/"><span class="card-category-list-name">MISC</span><span class="card-category-list-count">3</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/PWN/"><span class="card-category-list-name">PWN</span><span class="card-category-list-count">38</span></a><ul class="card-category-list child"><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/PWN/ARM/"><span class="card-category-list-name">ARM</span><span class="card-category-list-count">1</span></a></li></ul></li>
            </ul></div><div class="card-widget card-tags"><div class="item-headline"><i class="fas fa-tags"></i><span>标签</span></div><div class="card-tag-cloud"><a href="/tags/Dlink/" style="font-size: 1.15em; color: rgb(75, 70, 150)">Dlink</a><a href="/tags/Handsome/" style="font-size: 1.15em; color: rgb(76, 176, 53)">Handsome</a><a href="/tags/%E7%BE%8E%E5%8C%96/" style="font-size: 1.15em; color: rgb(88, 149, 83)">美化</a><a href="/tags/typecho/" style="font-size: 1.15em; color: rgb(83, 147, 5)">typecho</a><a href="/tags/WordPress/" style="font-size: 1.15em; color: rgb(23, 107, 79)">WordPress</a><a href="/tags/%E9%82%AE%E4%BB%B6%E9%80%9A%E7%9F%A5/" style="font-size: 1.15em; color: rgb(128, 94, 192)">邮件通知</a><a href="/tags/ida/" style="font-size: 1.25em; color: rgb(184, 22, 68)">ida</a><a href="/tags/grep/" style="font-size: 1.15em; color: rgb(192, 151, 34)">grep</a><a href="/tags/nfc/" style="font-size: 1.15em; color: rgb(46, 192, 125)">nfc</a><a href="/tags/PN532/" style="font-size: 1.15em; color: rgb(125, 73, 18)">PN532</a><a href="/tags/EOF/" style="font-size: 1.15em; color: rgb(194, 146, 124)">EOF</a><a href="/tags/unlink/" style="font-size: 1.35em; color: rgb(25, 9, 195)">unlink</a><a href="/tags/offbynull/" style="font-size: 1.25em; color: rgb(108, 116, 173)">offbynull</a><a href="/tags/scanf/" style="font-size: 1.15em; color: rgb(100, 195, 52)">scanf</a><a href="/tags/steam/" style="font-size: 1.15em; color: rgb(66, 188, 62)">steam</a><a href="/tags/asf/" style="font-size: 1.15em; color: rgb(178, 30, 104)">asf</a><a href="/tags/Steam%E4%BA%91%E6%8C%82%E5%8D%A1/" style="font-size: 1.15em; color: rgb(134, 76, 142)">Steam云挂卡</a><a href="/tags/%E4%BA%A4%E9%80%9A%E7%81%AF/" style="font-size: 1.15em; color: rgb(200, 148, 49)">交通灯</a><a href="/tags/%E5%8D%95%E7%89%87%E6%9C%BA/" style="font-size: 1.15em; color: rgb(14, 173, 141)">单片机</a><a href="/tags/C51/" style="font-size: 1.15em; color: rgb(29, 182, 122)">C51</a><a href="/tags/%E9%9A%A7%E9%81%93/" style="font-size: 1.15em; color: rgb(20, 197, 39)">隧道</a><a href="/tags/wireguard/" style="font-size: 1.15em; color: rgb(161, 121, 19)">wireguard</a><a href="/tags/%E4%B8%AD%E8%BD%AC%E6%B5%81%E9%87%8F/" style="font-size: 1.15em; color: rgb(119, 44, 95)">中转流量</a><a href="/tags/IPLC/" style="font-size: 1.15em; color: rgb(93, 75, 54)">IPLC</a><a href="/tags/Crypto/" style="font-size: 1.35em; color: rgb(113, 184, 7)">Crypto</a><a href="/tags/gmpy2/" style="font-size: 1.15em; color: rgb(173, 68, 25)">gmpy2</a><a href="/tags/RSA/" style="font-size: 1.15em; color: rgb(151, 128, 135)">RSA</a><a href="/tags/yafu/" style="font-size: 1.15em; color: rgb(110, 168, 149)">yafu</a><a href="/tags/firmadyne/" style="font-size: 1.15em; color: rgb(173, 62, 17)">firmadyne</a><a href="/tags/attify/" style="font-size: 1.15em; color: rgb(69, 182, 12)">attify</a><a href="/tags/%E6%96%87%E4%BB%B6%E7%BB%93%E6%9E%84/" style="font-size: 1.25em; color: rgb(24, 51, 64)">文件结构</a><a href="/tags/MISC/" style="font-size: 1.35em; color: rgb(117, 59, 96)">MISC</a><a href="/tags/volatility/" style="font-size: 1.15em; color: rgb(93, 165, 128)">volatility</a><a href="/tags/%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81/" style="font-size: 1.15em; color: rgb(18, 52, 85)">内存取证</a><a href="/tags/%E4%BC%AA%E5%8A%A0%E5%AF%86/" style="font-size: 1.15em; color: rgb(191, 23, 187)">伪加密</a><a href="/tags/ZIP%E5%8E%8B%E7%BC%A9%E5%8C%85/" style="font-size: 1.15em; color: rgb(67, 113, 54)">ZIP压缩包</a><a href="/tags/PWN/" style="font-size: 1.45em; color: rgb(153, 162, 147)">PWN</a><a href="/tags/ASLR/" style="font-size: 1.15em; color: rgb(15, 134, 114)">ASLR</a><a href="/tags/PIE/" style="font-size: 1.25em; color: rgb(87, 126, 169)">PIE</a><a href="/tags/gdb/" style="font-size: 1.25em; color: rgb(62, 44, 31)">gdb</a></div></div><div class="card-widget card-archives"><div class="item-headline"><i class="fas fa-archive"></i><span>归档</span><a class="card-more-btn" href="/archives/" title="查看更多">
    <i class="fas fa-angle-right"></i></a></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2021/07/"><span class="card-archive-list-date">七月 2021</span><span class="card-archive-list-count">2</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2021/06/"><span class="card-archive-list-date">六月 2021</span><span class="card-archive-list-count">4</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2021/05/"><span class="card-archive-list-date">五月 2021</span><span class="card-archive-list-count">10</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2021/04/"><span class="card-archive-list-date">四月 2021</span><span class="card-archive-list-count">4</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2021/03/"><span class="card-archive-list-date">三月 2021</span><span class="card-archive-list-count">6</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2021/02/"><span class="card-archive-list-date">二月 2021</span><span class="card-archive-list-count">7</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2021/01/"><span class="card-archive-list-date">一月 2021</span><span class="card-archive-list-count">6</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2020/12/"><span class="card-archive-list-date">十二月 2020</span><span class="card-archive-list-count">5</span></a></li></ul></div><div class="card-widget card-webinfo"><div class="item-headline"><i class="fas fa-chart-line"></i><span>网站资讯</span></div><div class="webinfo"><div class="webinfo-item"><div class="item-name">文章数目 :</div><div class="item-count">115</div></div><div class="webinfo-item"><div class="item-name">已运行时间 :</div><div class="item-count" id="runtimeshow" data-publishDate="2019-05-31T16:00:00.000Z"></div></div><div class="webinfo-item"><div class="item-name">本站总字数 :</div><div class="item-count">254.4k</div></div><div class="webinfo-item"><div class="item-name">本站访客数 :</div><div class="item-count" id="busuanzi_value_site_uv"></div></div><div class="webinfo-item"><div class="item-name">本站总访问量 :</div><div class="item-count" id="busuanzi_value_site_pv"></div></div><div class="webinfo-item"><div class="item-name">最后更新时间 :</div><div class="item-count" id="last-push-date" data-lastPushDate="2021-07-28T03:34:10.240Z"></div></div></div></div></div></div></main><footer id="footer" style="background-image: url('/img/background.jpg')"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2021 By SkYe231</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text"><a href="https://cloud.tencent.com/product/wh?from=12331" target="_blank">Hosted BY 云开发 Cloudbase</a>&nbsp;|&nbsp;<a href="https://www.upyun.com/?utm_source=lianmeng&utm_medium=referral" target="_blank"><img src= "data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=" data-lazy-src="https://mrskye.cn-gd.ufileos.com/img/2020-07-01-lGwrnPz3GuV4odmM.png" align="top" style="width:48px"></a><br /><div class="github-badge"><a rel="license" href="http://beian.miit.gov.cn/" target="_blank" title="粤ICP备20056619号"><span class="badge-subject">粤ICP备</span><span class="badge-value bg-black">20056619号</span></a></div></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="font-plus" type="button" title="放大字体"><i class="fas fa-plus"></i></button><button id="font-minus" type="button" title="缩小字体"><i class="fas fa-minus"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div></div><hr/><div id="local-search-results"></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.autoSpacingPage()
  else {
    getScript('https://cdn.jsdelivr.net/npm/pangu/dist/browser/pangu.min.js')
      .then(() => {
        pangu.autoSpacingPage()
      })
  }
}

function panguInit () {
  if (false){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><script src="/js/search/local-search.js"></script><script>var preloader = {
  endLoading: () => {
    document.body.style.overflow = 'auto';
    document.getElementById('loading-box').classList.add("loaded")
  },
  initLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.remove("loaded")

  }
}
window.addEventListener('load',preloader.endLoading())</script><div class="js-pjax"><script>function subtitleType () {
  fetch('https://v1.hitokoto.cn')
    .then(response => response.json())
    .then(data => {
      if (true) {
        var from = '出自 ' + data.from
        var sub = "".length == 0 ? new Array() : "".split(',')
        var both = sub.unshift(data.hitokoto, from)
        var typed = new Typed('#subtitle', {
          strings: sub,
          startDelay: 300,
          typeSpeed: 150,
          loop: true,
          backSpeed: 50,
        })
      } else {
        document.getElementById('subtitle').innerHTML = data.hitokoto
      }
    })
}

if (true) {
  if (typeof Typed === 'function') {
    subtitleType()
  } else {
    getScript('https://cdn.jsdelivr.net/npm/typed.js/lib/typed.min.js').then(subtitleType)
  }
} else {
  subtitleType()
}
</script><script>if (document.getElementsByClassName('mermaid').length) {
  if (window.mermaidJsLoad) mermaid.init()
  else {
    getScript('https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js').then(() => {
      window.mermaidJsLoad = true
      mermaid.initialize({
        theme: 'default',
      })
      false && mermaid.init()
    })
  }
}</script></div><script defer="defer" id="ribbon" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-ribbon.min.js" size="150" alpha="0.6" zIndex="-1" mobile="false" data-click="false"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = false;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><script id="click-show-text" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/click-show-text.min.js" data-mobile="false" data-text="富强,民主,文明,和谐,自由,平等,公正,法治,爱国,敬业,诚信,友善" data-fontsize="15px" data-random="true" async="async"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>